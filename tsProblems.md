# TypeScript Project Audit Report

## Summary

This document contains the results of a comprehensive TypeScript project audit covering code duplication, architecture, performance, typing, data handling, async patterns, imports, code smells, and **clean code analysis**.

**–ü–æ—Å–ª–µ–¥–Ω–∏–π –∞—É–¥–∏—Ç:** –î–µ–∫–∞–±—Ä—å 2024

**–°—Ç–∞—Ç—É—Å –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–¥–∞—á:** ‚úÖ –í–°–ï –ó–ê–î–ê–ß–ò –í–´–ü–û–õ–ù–ï–ù–´ (—Ä–∞–∑–¥–µ–ª—ã 1-9).

**Clean Code Audit (–†–∞–∑–¥–µ–ª 9):** ‚ö†Ô∏è –ù–∞–π–¥–µ–Ω–æ 6 –ø—Ä–æ–±–ª–µ–º (—Å–º. —Ä–∞–∑–¥–µ–ª 10.1)

**–ù–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (–†–∞–∑–¥–µ–ª 10):** 9 –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á –≤—ã—è–≤–ª–µ–Ω–æ:
- üî¥ –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 2 –∑–∞–¥–∞—á–∏ (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ color sampling)
- üü° –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 2 –∑–∞–¥–∞—á–∏ (–¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è CameraPage)
- üü¢ –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 5 –∑–∞–¥–∞—á (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è)

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —Ä–∞–Ω–µ–µ:**
- ‚úÖ –°–µ—Ä–≤–µ—Ä–Ω—ã–π –ª–æ–≥–≥–µ—Ä (server/logger.ts) - —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ ESLint –ø—Ä–∞–≤–∏–ª–æ no-console - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å console.log

---

## 1. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–≤—Ç–æ—Ä—ã

### 1.1 –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—É–∫–æ–≤ –∂–µ—Å—Ç–æ–≤
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/hooks/use-gestures.ts` –∏ `client/src/hooks/use-long-press.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:** –û–±–∞ —Ö—É–∫–∞ –∏–º–µ—é—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è:
- –û–±—Ä–∞–±–æ—Ç–∫–∏ long press —Å —Ç–∞–π–º–µ—Ä–æ–º
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ –∫–∞—Å–∞–Ω–∏—è
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –¥–ª—è –æ—Ç–º–µ–Ω—ã long press
- ~~–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã `DEFAULT_LONG_PRESS_DELAY = 500` –∏ `DEFAULT_MOVE_THRESHOLD = 10`~~

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ò–∑–≤–ª–µ—á—å –æ–±—â—É—é –ª–æ–≥–∏–∫—É –≤ –±–∞–∑–æ–≤—ã–π —Ö—É–∫ –∏–ª–∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–°–æ–∑–¥–∞–Ω –±–∞–∑–æ–≤—ã–π —Ö—É–∫ `useTouchTracking` –≤ `client/src/hooks/use-touch-tracking.ts`:
- –û–±—â–∞—è –ª–æ–≥–∏–∫–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–∞—Å–∞–Ω–∏–π
- –¢–∞–π–º–µ—Ä long press —Å –æ—á–∏—Å—Ç–∫–æ–π
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ moveThreshold –¥–ª—è –æ—Ç–º–µ–Ω—ã

```
‚úÖ –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π —Ö—É–∫ useTouchTracking —Å –æ–±—â–µ–π –ª–æ–≥–∏–∫–æ–π
‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å use-gestures.ts –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ —Ö—É–∫–∞
‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å use-long-press.ts –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ —Ö—É–∫–∞
‚úÖ –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –æ–±—â–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ constants.ts (LONG_PRESS.DEFAULT_DELAY_MS, LONG_PRESS.DEFAULT_MOVE_THRESHOLD_PX)
```

### 1.2 –ü–∞—Ç—Ç–µ—Ä–Ω UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Radix
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/components/ui/` (alert-dialog.tsx, dialog.tsx, drawer.tsx, dropdown-menu.tsx, sheet.tsx, popover.tsx, select.tsx, toast.tsx, tooltip.tsx –∏ –¥—Ä.)

**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–ª–µ–¥—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º—É —à–∞–±–ª–æ–Ω—É:
- forwardRef wrapper
- cn() –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤
- displayName –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ
- Overlay —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏ `bg-black/80`

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω shadcn/ui, –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –ù–æ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å helper –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å—Ç–∏–ª–µ–π overlay.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–°–æ–∑–¥–∞–Ω `client/src/components/ui/styles.ts`:
- `overlayStyles` - –æ–±—â–∏–µ —Å—Ç–∏–ª–∏ overlay –∞–Ω–∏–º–∞—Ü–∏–π
- `dialogContentStyles` - —Å—Ç–∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–∏–∞–ª–æ–≥–æ–≤
- `dialogCloseButtonStyles` - —Å—Ç–∏–ª–∏ –∫–Ω–æ–ø–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è
- `dialogHeaderStyles` - —Å—Ç–∏–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤
- `dialogFooterStyles` - —Å—Ç–∏–ª–∏ —Ñ—É—Ç–µ—Ä–∞ –¥–∏–∞–ª–æ–≥–æ–≤

–û–±–Ω–æ–≤–ª–µ–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `alert-dialog.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç overlayStyles –∏ dialogContentStyles
- `dialog.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç overlayStyles, dialogContentStyles, dialogCloseButtonStyles
- `sheet.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç overlayStyles –∏ dialogCloseButtonStyles

```
‚úÖ [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] –°–æ–∑–¥–∞—Ç—å –æ–±—â–∏–π overlayStyles constant –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∫–ª–∞—Å—Å–æ–≤ –∞–Ω–∏–º–∞—Ü–∏–π
‚úÖ [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω –≤ ARCHITECTURE.md –¥–ª—è onboarding –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
```

### 1.3 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Settings Sections
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/settings/sections/*.tsx`

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–µ–∫—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–º–µ—é—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â—É—é—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É:
- CollapsibleCard wrapper
- Label —Å –∏–∫–æ–Ω–∫–æ–π
- Switch/Slider –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- Separator –º–µ–∂–¥—É —Å–µ–∫—Ü–∏—è–º–∏

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —Ç–∏–ø–∏—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–∫.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–°–æ–∑–¥–∞–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `client/src/components/ui/setting-row.tsx` - –¥–ª—è label + switch/control
- `client/src/components/ui/setting-slider.tsx` - –¥–ª—è slider —Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º label –∏ value display

–†–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω—ã —Å–µ–∫—Ü–∏–∏:
- `GeneralSettingsSection.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SettingRow
- `CameraSettingsSection.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SettingRow –∏ SettingSlider
- `ReticleSection.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SettingRow –∏ SettingSlider
- `ImageQualitySection.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SettingRow –∏ SettingSlider
- `WatermarkSection.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SettingRow –∏ SettingSlider

```
‚úÖ –°–æ–∑–¥–∞—Ç—å SettingRow –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è label + switch/slider
‚úÖ –°–æ–∑–¥–∞—Ç—å SettingSlider –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º label –∏ value display
‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ–∫—Ü–∏–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (GeneralSettingsSection, CameraSettingsSection)
‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (ReticleSection, ImageQualitySection, WatermarkSection)
```

---

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### 2.1 –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** 
- `client/src/pages/gallery/index.tsx` (~~636 —Å—Ç—Ä–æ–∫~~ ‚Üí 643 —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)
- `client/src/pages/camera/index.tsx` (~~401 —Å—Ç—Ä–æ–∫–∞~~ ‚Üí ~350 —Å—Ç—Ä–æ–∫ –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)

**–ü—Ä–æ–±–ª–µ–º–∞:** ~~–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ª–æ–≥–∏–∫–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π~~

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ß–ê–°–¢–ò–ß–ù–û –í–´–ü–û–õ–ù–ï–ù–û

GalleryPage —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ö—É–∫–∏:
- `useGallerySelection` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º
- `useGalleryView` - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–æ–≤ –∏ –ø–∞–ø–æ–∫
- `useGalleryFilters` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
- `useGalleryPhotos` - –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è —Ñ–æ—Ç–æ
- `useUploadHandler` - –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –æ–±–ª–∞–∫–æ
- `useLinksDialog` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–æ–º —Å—Å—ã–ª–æ–∫

CameraPage —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
- `useColorSampling` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ –ø—Ä–∏—Ü–µ–ª–∞
- `useCaptureController` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å—ä—ë–º–∫–∏ —á–µ—Ä–µ–∑ useReducer

```
‚úÖ –ò–∑–≤–ª–µ—á—å useUploadHandler –∏–∑ GalleryPage
‚úÖ –ò–∑–≤–ª–µ—á—å useGalleryDialogs –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –¥–∏–∞–ª–æ–≥–æ–≤ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–∞–∫ useLinksDialog + useGallerySelection)
‚úÖ –ò–∑–≤–ª–µ—á—å ColorSamplingProvider –∏–ª–∏ —Ö—É–∫ –∏–∑ CameraPage (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–∞–∫ useColorSampling)
‚úÖ useCaptureController —Å useReducer - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π lifecycle
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è useCaptureController:**
- `CAPTURE_START` ‚Üí `{isCapturing: true, isProcessing: false}`
- `CAPTURE_SUCCESS` ‚Üí `{isCapturing: false, isProcessing: true}`
- `CAPTURE_FAILED` ‚Üí `{isCapturing: false, isProcessing: false}` - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—á–∏—â–∞–µ—Ç –æ–±–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `PROCESSING_COMPLETE` ‚Üí `{isCapturing: false, isProcessing: false}`
- `ABORT` ‚Üí `{isCapturing: false, isProcessing: false}` - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—á–∏—â–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π cleanup AbortController –≤ useEffect

### 2.2 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–ª–æ—è —Å–µ—Ä–≤–∏—Å–æ–≤
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** ~~`client/src/lib/db.ts` (705 —Å—Ç—Ä–æ–∫)~~ ‚Üí `client/src/lib/db/`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ–ø–µ—Ä—å:
```
client/src/lib/db/
‚îú‚îÄ‚îÄ db-core.ts        # –ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ IndexedDB, openDB, generateId, –∫–µ—à —Å –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
‚îú‚îÄ‚îÄ photo-service.ts  # –û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏
‚îú‚îÄ‚îÄ folder-service.ts # –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–∞–ø–∫–∞–º–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
‚îú‚îÄ‚îÄ settings-service.ts # –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
‚îú‚îÄ‚îÄ storage-service.ts  # –£—Ç–∏–ª–∏—Ç—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è
‚îî‚îÄ‚îÄ index.ts          # –†–µ—ç–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
```

```
‚úÖ –°–æ–∑–¥–∞—Ç—å client/src/lib/db/photo-service.ts –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ —Ñ–æ—Ç–æ
‚úÖ –°–æ–∑–¥–∞—Ç—å client/src/lib/db/settings-service.ts –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å –≤ db-core.ts —Ç–æ–ª—å–∫–æ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å IndexedDB
‚úÖ –°–æ–∑–¥–∞—Ç—å folder-service.ts –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–∞–ø–∫–∞–º–∏
‚úÖ –°–æ–∑–¥–∞—Ç—å storage-service.ts –¥–ª—è —É—Ç–∏–ª–∏—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è
```

---

## 3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 3.1 –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ await –≤–º–µ—Å—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/camera/index.tsx` —Å—Ç—Ä–æ–∫–∏ 78-98

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–¢–µ–∫—É—â–∏–π –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Promise.all`:
```typescript
const [counts, latest] = await Promise.all([
  getPhotoCounts(),
  getLatestPhoto(),
]);
```

```
‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å loadPhotos –≤ camera/index.tsx –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```

### 3.2 –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/gallery/index.tsx` —Å—Ç—Ä–æ–∫–∏ 226-263

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–¢–µ–∫—É—â–∏–π –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Promise.all` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏:
```typescript
const imageDataResults = await Promise.all(
  selectedPhotos.map(async (photo) => {
    const imageData = await getPhotoImageData(photo.id);
    const blob = await createCleanImageBlob(imageData);
    return { photo, blob };
  })
);
```

```
‚úÖ –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∏—Ç—å imageData –¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ Promise.all
‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞
‚úÖ –£–¥–∞–ª–µ–Ω–∞ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
```

### 3.3 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ–º–æ–∏–∑–∞—Ü–∏–∏ –≤ PhotoListItem –∏ PhotoGridCell
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** ~~`client/src/components/virtualized-gallery.tsx`~~ ‚Üí `client/src/components/virtualized-gallery/`

**–ü—Ä–æ–±–ª–µ–º–∞:** ~~–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ callback —Ñ—É–Ω–∫—Ü–∏–∏ `handleLongPress` –∏ `handleClick` —Å–æ–∑–¥–∞—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ memo wrapper.~~

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

- `handleClick` —Ç–µ–ø–µ—Ä—å –æ–±—ë—Ä–Ω—É—Ç –≤ `useCallback` –≤ –æ–±–æ–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- `handleLongPress` —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `useCallback`
- `data` –¥–ª—è longPressHandlers - –ø—Ä–∏–º–∏—Ç–∏–≤ (string), –º–µ–º–æ–∏–∑–∞—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

```
‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å useCallback –¥–ª—è handleClick –≤ PhotoListItemBase –∏ PhotoGridCellBase
‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ useCallback –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
```

### 3.4 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ debounce –¥–ª—è color sampling
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/camera/index.tsx` —Å—Ç—Ä–æ–∫–∏ 130-208

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `previousColorRef` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ª–∏—à–Ω–∏—Ö —Ä–µ—Ä–µ–Ω–¥–µ—Ä–æ–≤:
```typescript
const previousColorRef = useRef<string>(CAMERA.DEFAULT_RETICLE_COLOR);
// ...
const newColor = getContrastingColor(r, g, b, colorScheme);
if (newColor !== previousColorRef.current) {
  previousColorRef.current = newColor;
  setReticleColor(newColor);
}
```

```
‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ü–≤–µ—Ç–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø–µ—Ä–µ–¥ setReticleColor
‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å useRef –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ü–≤–µ—Ç–∞
```

---

## 4. –¢–∏–ø–∏–∑–∞—Ü–∏—è

### 4.1 –°—Ç–∞—Ç—É—Å —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** ‚úÖ –û—Ç–ª–∏—á–Ω–æ

- –ù–µ –Ω–∞–π–¥–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `any` —Ç–∏–ø–æ–≤
- –ù–µ –Ω–∞–π–¥–µ–Ω–æ `@ts-ignore` –∏–ª–∏ `@ts-nocheck` –¥–∏—Ä–µ–∫—Ç–∏–≤
- –¢–∏–ø—ã —Ö–æ—Ä–æ—à–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `shared/schema.ts`

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - —Ç–∏–ø–∏–∑–∞—Ü–∏—è –≤ —Ö–æ—Ä–æ—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
```

---

## 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### 5.1 –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/lib/db/folder-service.ts` —Ñ—É–Ω–∫—Ü–∏—è `getFolderStats`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ—Ö–æ–¥ –ø–æ –≤—Å–µ–º –∑–∞–ø–∏—Å—è–º –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ (—Å TTL –∫–µ—à–µ–º).

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–∏ –º—É—Ç–∞—Ü–∏—è—Ö.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–∞:
- `updateCacheOnPhotoAdd()` - –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–µ—à –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ñ–æ—Ç–æ
- `updateCacheOnPhotoDelete()` - –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–µ—à –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–æ—Ç–æ
- `updateCacheOnPhotoUpload()` - –æ–±–Ω–æ–≤–ª—è–µ—Ç uploadedCount –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤ –æ–±–ª–∞–∫–æ
- `invalidateFolderCountsCache()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ clearAllPhotos –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞
- TTL –∫–µ—à–∞ 30 —Å–µ–∫—É–Ω–¥

```
‚úÖ [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] –£–≤–µ–ª–∏—á–∏—Ç—å TTL –∫–µ—à–∞ –µ—Å–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–¥–∫–æ –º–µ–Ω—è–µ—Ç—Å—è (5—Å ‚Üí 30—Å)
‚úÖ –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–∞ - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –∫–µ—à–∞:**
- `savePhoto()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `updateCacheOnPhotoAdd(folder, thumbnailData, timestamp, isUploaded)`
- `deletePhoto()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `updateCacheOnPhotoDelete(folder, wasUploaded, wasLatestInFolder)` —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π latestTimestamp
- `updatePhoto()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `updateCacheOnFolderChange()` –ø—Ä–∏ —Å–º–µ–Ω–µ –ø–∞–ø–∫–∏, –∏–ª–∏ `updateCacheOnPhotoUpload(folder)` –ø—Ä–∏ –Ω–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
- `clearAllPhotos()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `invalidateFolderCountsCache()` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞

**–ì–∞—Ä–∞–Ω—Ç–∏–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏:**
- –ò–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç –Ω–æ–≤—ã–µ Map/–º–∞—Å—Å–∏–≤—ã –ø–µ—Ä–µ–¥ –º—É—Ç–∞—Ü–∏–µ–π
- –°–º–µ–Ω–∞ –ø–∞–ø–∫–∏: –ø–æ–ª–Ω–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–µ—à–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–µ—Ä–µ—Å—á—ë—Ç–∞
- –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ñ–æ—Ç–æ –ø–∞–ø–∫–∏: –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è folderStatsCache –¥–ª—è –ø–µ—Ä–µ—Å—á—ë—Ç–∞ latestThumb
- –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω–æ–≥–æ increment: updatePhoto –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `!wasUploaded && isNowUploaded`

---

## 6. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å

### 6.1 –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AbortController
**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** ‚úÖ –•–æ—Ä–æ—à–æ

–ù–∞–π–¥–µ–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AbortController:
- `client/src/hooks/use-photo-navigator.ts` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π cleanup
- `client/src/lib/capture-helpers.ts` - –ø—Ä–æ–≤–µ—Ä–∫–∞ signal.aborted
- `client/src/pages/gallery/index.tsx` - upload cancellation

### 6.2 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ debounce –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/lib/settings-context.tsx`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ - debounce —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (—Å—Ç—Ä–æ–∫–∞ 27)

### 6.3 Throttle –¥–ª—è orientation
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/hooks/use-orientation.ts`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ - throttle —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (—Å—Ç—Ä–æ–∫–∏ 91-99)

```
‚úÖ –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á –ø–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏
```

---

## 7. –ò–º–ø–æ—Ä—Ç—ã –∏ –±–∞–Ω–¥–ª

### 7.1 Lazy Loading
**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

Lazy loading –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ `client/src/App.tsx`:
- CameraPage, GalleryPage, PhotoDetailPage, SettingsPage, GamePage - –≤—Å–µ lazy loaded

### 7.2 Virtualization
**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

–í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ `client/src/components/virtualized-gallery.tsx` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º react-window.

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - code splitting –∏ virtualization –≤ —Ö–æ—Ä–æ—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
```

---

## 8. –ö–æ–¥-—Å–º–µ–ª–ª—ã

### 8.1 –î–ª–∏–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω–æ

- ~~`client/src/lib/db.ts` - 705 —Å—Ç—Ä–æ–∫~~ ‚Üí –†–∞–∑–±–∏—Ç –Ω–∞ –º–æ–¥—É–ª–∏ –≤ `client/src/lib/db/`
- `client/src/pages/gallery/index.tsx` - 643 —Å—Ç—Ä–æ–∫–∏ (–ª–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —Ö—É–∫–∏)
- ~~`client/src/components/virtualized-gallery.tsx` - 467 —Å—Ç—Ä–æ–∫~~ ‚Üí –†–∞–∑–±–∏—Ç –Ω–∞ –º–æ–¥—É–ª–∏ –≤ `client/src/components/virtualized-gallery/`
- `client/src/pages/camera/index.tsx` - ~350 —Å—Ç—Ä–æ–∫ (–ª–æ–≥–∏–∫–∞ color sampling –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ useColorSampling)

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ virtualized-gallery:
```
client/src/components/virtualized-gallery/
‚îú‚îÄ‚îÄ types.ts              # –û–±—â–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
‚îú‚îÄ‚îÄ VirtualizedList.tsx   # PhotoListItem + VirtualizedPhotoList
‚îú‚îÄ‚îÄ VirtualizedGrid.tsx   # PhotoGridCell + VirtualizedPhotoGrid
‚îú‚îÄ‚îÄ AutoSizerContainer.tsx # AutoSizerContainer
‚îî‚îÄ‚îÄ index.ts              # –†–µ—ç–∫—Å–ø–æ—Ä—Ç
```

```
‚úÖ –†–∞–∑–±–∏—Ç—å db.ts –Ω–∞ –º–æ–¥—É–ª–∏ (—Å–º. —Ä–∞–∑–¥–µ–ª 2.2)
‚úÖ –†–∞–∑–±–∏—Ç—å gallery/index.tsx - –ª–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —Ö—É–∫–∏
‚úÖ –†–∞–∑–±–∏—Ç—å virtualized-gallery.tsx –Ω–∞ VirtualizedList –∏ VirtualizedGrid —Ñ–∞–π–ª—ã
```

### 8.2 –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞
**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** ‚úÖ –•–æ—Ä–æ—à–æ

–ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ `client/src/lib/constants.ts`:
- TIMING, GESTURE, GAME, UPLOAD, STORAGE_KEYS, PATTERN_LOCK, IMAGE, SENSORS, CAMERA, GALLERY, UI, LONG_PRESS

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û - `CAMERA.DEFAULT_RETICLE_SIZE` –¥–æ–±–∞–≤–ª–µ–Ω –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
```typescript
const sizePercent = settings.reticle.size || CAMERA.DEFAULT_RETICLE_SIZE;
```

```
‚úÖ –î–æ–±–∞–≤–∏—Ç—å DEFAULT_RETICLE_SIZE –≤ constants.ts
‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å hardcoded –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É
```

### 8.3 –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ useCallback
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/camera/index.tsx` —Å—Ç—Ä–æ–∫–∞ 271

**–ü—Ä–æ–±–ª–µ–º–∞:** ~~handleCapture –∏–º–µ–µ—Ç –º–Ω–æ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –º–∞—Å—Å–∏–≤–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.~~

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ß–ê–°–¢–ò–ß–ù–û –í–´–ü–û–õ–ù–ï–ù–û

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:
- `captureConfig` –æ–±—ä–µ–∫—Ç —á–µ—Ä–µ–∑ `useMemo` –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- Inline state management —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

```
‚úÖ –°–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç captureConfig –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚úÖ useCaptureController —Å useReducer - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π lifecycle
```

### 8.4 Cleanup —Ñ—É–Ω–∫—Ü–∏–∏ –≤ useEffect
**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** ‚úÖ –•–æ—Ä–æ—à–æ

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ useEffect hooks –∏–º–µ—é—Ç cleanup —Ñ—É–Ω–∫—Ü–∏–∏:
- `use-camera.ts` - stopCamera cleanup
- `use-orientation.ts` - removeEventListener + clearTimeout
- `use-stabilization.ts` - cancelAnimationFrame
- `use-photo-navigator.ts` - AbortController abort
- `use-gestures.ts` - clearLongPressTimer
- `use-capture-controller.ts` - AbortController abort (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π cleanup)

---

## –ß–µ–∫-–ª–∏—Å—Ç –∑–∞–¥–∞—á –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

```
‚úÖ [PERF-1] –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–æ–≤–∞—Ç—å getPhotoCounts() –∏ getLatestPhoto() –≤ camera/index.tsx
‚úÖ [PERF-2] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å handleDownloadSelected –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚úÖ [PERF-3] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–≤–µ—Ç–∞ –ø–µ—Ä–µ–¥ setReticleColor
‚úÖ [ARCH-1] –†–∞–∑–±–∏—Ç—å db.ts –Ω–∞ photo-service.ts, settings-service.ts, folder-service.ts, storage-service.ts –∏ db-core.ts
‚úÖ [ARCH-2] –ò–∑–≤–ª–µ—á—å —Ö—É–∫–∏ –∏–∑ GalleryPage (useUploadHandler, useGallerySelection, useGalleryFilters, useGalleryPhotos, useGalleryView, useLinksDialog)
```

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥)

```
‚úÖ [DUP-1] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É use-gestures.ts –∏ use-long-press.ts (—Å–æ–∑–¥–∞—Ç—å useTouchTracking)
‚úÖ [DUP-2] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –æ–±—â–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã DEFAULT_LONG_PRESS_DELAY, DEFAULT_MOVE_THRESHOLD –≤ constants.ts
‚úÖ [REF-1] –°–æ–∑–¥–∞—Ç—å –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã SettingRow –∏ SettingSlider
‚úÖ [REF-2] –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ handleCapture –≤ captureConfig –æ–±—ä–µ–∫—Ç
```

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è)

```
‚úÖ [OPT-1] –î–æ–±–∞–≤–∏—Ç—å DEFAULT_RETICLE_SIZE –≤ constants.ts
‚úÖ [OPT-2] –£–≤–µ–ª–∏—á–∏—Ç—å TTL –∫–µ—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–∞–ø–æ–∫ (5—Å ‚Üí 30—Å)
‚úÖ [OPT-3] –†–∞–∑–±–∏—Ç—å virtualized-gallery.tsx –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
‚úÖ [OPT-4] –°–æ–∑–¥–∞—Ç—å overlayStyles constant –¥–ª—è UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚úÖ [OPT-5] –ò–∑–≤–ª–µ—á—å useColorSampling —Ö—É–∫ –∏–∑ CameraPage
‚úÖ [OPT-6] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ ARCHITECTURE.md
‚úÖ [OPT-7] useCaptureController —Å useReducer - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π lifecycle
‚úÖ [OPT-8] –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

---

## –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞

1. ‚úÖ **–¢–∏–ø–∏–∑–∞—Ü–∏—è** - –û—Ç–ª–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TypeScript –±–µ–∑ any –∏ ts-ignore
2. ‚úÖ **Lazy Loading** - –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å—Ç—Ä–∞–Ω–∏—Ü
3. ‚úÖ **Virtualization** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ react-window –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏
4. ‚úÖ **Constants** - –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ constants.ts
5. ‚úÖ **Error Handling** - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ async –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
6. ‚úÖ **AbortController** - –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–º–µ–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–π
7. ‚úÖ **Debounce/Throttle** - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≥–¥–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
8. ‚úÖ **Cleanup** - useEffect hooks –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ cleanup —Ñ—É–Ω–∫—Ü–∏–∏
9. ‚úÖ **i18n** - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
10. ‚úÖ **Memo** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ React.memo –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
11. ‚úÖ **Service Layer** - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ db.ts –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
12. ‚úÖ **Custom Hooks** - –•–æ—Ä–æ—à–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –ª–æ–≥–∏–∫–∏ GalleryPage –≤ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ö—É–∫–∏
13. ‚úÖ **Shared Touch Tracking** - –ë–∞–∑–æ–≤—ã–π —Ö—É–∫ useTouchTracking –¥–ª—è –æ–±—â–µ–π –ª–æ–≥–∏–∫–∏ –∂–µ—Å—Ç–æ–≤
14. ‚úÖ **Reusable Settings Components** - SettingRow –∏ SettingSlider –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
15. ‚úÖ **Grouped Dependencies** - captureConfig –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π handleCapture
16. ‚úÖ **Memoized Callbacks** - handleClick –æ–±—ë—Ä–Ω—É—Ç –≤ useCallback –≤ virtualized-gallery
17. ‚úÖ **Modular Gallery Components** - virtualized-gallery —Ä–∞–∑–±–∏—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
18. ‚úÖ **Architecture Documentation** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤ ARCHITECTURE.md
19. ‚úÖ **Capture State Machine** - useCaptureController —Å useReducer –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å—ä—ë–º–∫–∏
20. ‚úÖ **Incremental Cache** - –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–∞–ø–æ–∫ –±–µ–∑ –ø–æ–ª–Ω–æ–π –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏

---

## 9. –ê–Ω–∞–ª–∏–∑ —á–∏—Å—Ç–æ—Ç—ã –∫–æ–¥–∞ (Clean Code Audit)

### 9.1 –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û

ESLint —Å –ø–ª–∞–≥–∏–Ω–æ–º `unused-imports` –Ω–µ –≤—ã—è–≤–∏–ª –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ.

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
```

### 9.2 –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û

TypeScript –∏ ESLint –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–µ –≤—ã—è–≤–∏–ª–∏ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

**–ü–∞—Ç—Ç–µ—Ä–Ω —Å underscore –¥–ª—è –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è:**
–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏–∏ —Å underscore –¥–ª—è –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ–≥–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π:
- `client/src/lib/db/photo-service.ts:132` - `const { imageData: _, thumbnailData: __, ...summary } = photo;`
- `client/src/lib/db/photo-service.ts:159` - `const { imageData: _, ...withThumbnail } = photo;`
- `client/src/lib/db/photo-service.ts:225` - `const { imageData: _, ...withThumbnail } = photo;`

–≠—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω TypeScript –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø–æ–ª–µ–π –ø—Ä–∏ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏–∏.

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - –ø–∞—Ç—Ç–µ—Ä–Ω —Å underscore –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

### 9.3 –ú—ë—Ä—Ç–≤—ã–π –∫–æ–¥
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û

- –ù–µ–¥–æ—Å—Ç–∏–∂–∏–º—ã–π –∫–æ–¥ –ø–æ—Å–ª–µ return/throw/break - –Ω–µ –Ω–∞–π–¥–µ–Ω
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –º–µ—Ç–æ–¥—ã - –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ - –Ω–µ –Ω–∞–π–¥–µ–Ω (—Ç–æ–ª—å–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏)

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - –º—ë—Ä—Ç–≤—ã–π –∫–æ–¥ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
```

### 9.4 –ò–∑–±—ã—Ç–æ—á–Ω—ã–π –∫–æ–¥
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û

- –ü—É—Å—Ç—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ —Ç–∏–ø—ã - –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ - –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è (if true/false) - –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- –ù–µ–Ω—É–∂–Ω—ã–µ else –ø–æ—Å–ª–µ return - –Ω–µ –Ω–∞–π–¥–µ–Ω—ã

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - –∏–∑–±—ã—Ç–æ—á–Ω—ã–π –∫–æ–¥ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
```

### 9.5 –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–∏–ø—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û

–í—Å–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ –∏ –Ω–µ—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ —Ç–∏–ø—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∫–æ–¥–µ.

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - –≤—Å–µ —Ç–∏–ø—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
```

### 9.6 –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –ª–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π –∫–æ–¥
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ö–û–†–†–ï–ö–¢–ù–û

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ:**
- `client/src/lib/logger.ts:36-77` - console.debug/info/warn/error - **–ù–ê–ú–ï–†–ï–ù–ù–û** (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä)
- `server/index.ts:54` - console.log - **–ù–ê–ú–ï–†–ï–ù–ù–û** (—Å–µ—Ä–≤–µ—Ä–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤)
- `client/src/docs/ARCHITECTURE.md:84` - console.log - **–î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø** (–ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞)

–í—Å–µ console.* –≤—ã–∑–æ–≤—ã –ª–∏–±–æ —è–≤–ª—è—é—Ç—Å—è —á–∞—Å—Ç—å—é —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –ª–∏–±–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è. Debugger statements –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã.

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

### 9.7 –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ type assertions
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û

- `as any` - –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∏ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
- `@ts-ignore` / `@ts-nocheck` / `@ts-expect-error` - –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- –ù–µ–Ω—É–∂–Ω—ã–µ type assertions - –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - type assertions –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

---

## –ß–µ–∫-–ª–∏—Å—Ç –∑–∞–¥–∞—á –¥–ª—è Clean Code Audit

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–±–ª–µ–º—ã |
|----------|--------|----------|
| –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| –ú—ë—Ä—Ç–≤—ã–π –∫–æ–¥ | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| –ü—É—Å—Ç—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã/—Ç–∏–ø—ã | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Ç–∏–ø—ã | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–∏–ø—ã | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| Console.log (–∫—Ä–æ–º–µ –ª–æ–≥–≥–µ—Ä–∞) | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| Debugger statements | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| @ts-ignore/@ts-nocheck | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| as any | ‚úÖ –ß–∏—Å—Ç–æ | 0 |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```
‚úÖ [REC-1] –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é server/index.ts console.log –Ω–∞ –æ–±—â–∏–π logger
    –§–∞–π–ª: server/logger.ts (—Å–æ–∑–¥–∞–Ω), server/index.ts (–æ–±–Ω–æ–≤–ª—ë–Ω)
    –†–µ–∞–ª–∏–∑–∞—Ü–∏—è: –°–æ–∑–¥–∞–Ω —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –ª–æ–≥–≥–µ—Ä —Å –º–µ—Ç–æ–¥–∞–º–∏ debug/info/warn/error/log
    –°—Ç–∞—Ç—É—Å: –í–´–ü–û–õ–ù–ï–ù–û

‚úÖ [REC-2] –î–æ–±–∞–≤–∏—Ç—å ESLint –ø—Ä–∞–≤–∏–ª–æ no-console –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è
    –§–∞–π–ª: eslint.config.js
    –†–µ–∞–ª–∏–∑–∞—Ü–∏—è: –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–æ "no-console": ["warn", { allow: ["warn", "error"] }]
    –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è —Ñ–∞–π–ª–æ–≤ **/logger.ts
    –°—Ç–∞—Ç—É—Å: –í–´–ü–û–õ–ù–ï–ù–û
```

---

## 10. –ê—É–¥–∏—Ç –¥–µ–∫–∞–±—Ä—å 2024

### 10.1 –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ color sampling
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** 
- `client/src/hooks/use-color-sampling.ts` (–æ—Å–Ω–æ–≤–Ω–æ–π —Ö—É–∫)
- `client/src/pages/camera/index.tsx` (—Ñ—É–Ω–∫—Ü–∏–∏ `sampleColorFromVideo`, `sampleColorFromImage`, `sampleColorFromFrozenFrame`)

**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–æ–≥–∏–∫–∞ —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–≤–µ—Ç–∞ –∏–∑ –≤–∏–¥–µ–æ/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ CameraPage, —Ö–æ—Ç—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö—É–∫ `useColorSampling`. –û–±–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- –°–æ–∑–¥–∞—é—Ç canvas –∏ –ø–æ–ª—É—á–∞—é—Ç context
- –í—ã—á–∏—Å–ª—è—é—Ç —Ä–∞–∑–º–µ—Ä –æ–±–ª–∞—Å—Ç–∏ —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –†–∏—Å—É—é—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç –≤–∏–¥–µ–æ/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –°—á–∏—Ç–∞—é—Ç —Å—Ä–µ–¥–Ω–∏–π —Ü–≤–µ—Ç –ø–æ –ø–∏–∫—Å–µ–ª—è–º
- –í—ã–∑—ã–≤–∞—é—Ç `getContrastingColor()`

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –†–∞—Å—à–∏—Ä–∏—Ç—å `useColorSampling` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑ –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω–æ–≥–æ –∫–∞–¥—Ä–∞ –∏–ª–∏ –∏–∑–≤–ª–µ—á—å –æ–±—â—É—é —É—Ç–∏–ª–∏—Ç—É `sampleColorFromSource()`.

```
‚¨ú [DUP-3] –ò–∑–≤–ª–µ—á—å –æ–±—â—É—é —Ñ—É–Ω–∫—Ü–∏—é sampleColorFromCanvas –≤ lib/canvas-utils.ts
‚¨ú [DUP-4] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å sampleColorFromVideo/sampleColorFromFrozenFrame –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏
```

### 10.2 –ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä CameraPage
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/camera/index.tsx` (638 —Å—Ç—Ä–æ–∫, 20 useCallback, 4 useState)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç CameraPage —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–µ–π:
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–∞–º–µ—Ä—ã
- –õ–æ–≥–∏–∫–∞ —Ä—É—á–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ (adjustmentMode)
- Color sampling –¥–ª—è –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω–æ–≥–æ –∫–∞–¥—Ä–∞
- GPS gating –ª–æ–≥–∏–∫–∞
- –ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—Ö–≤–∞—Ç–∞ —Ñ–æ—Ç–æ (handleCapture, handleCaptureWithPosition, handleCaptureFromFrozenFrame)

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ò–∑–≤–ª–µ—á—å –ª–æ–≥–∏–∫—É —Ä—É—á–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ö—É–∫ `useAdjustmentMode`.

```
‚¨ú [ARCH-3] –°–æ–∑–¥–∞—Ç—å useAdjustmentMode —Ö—É–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–º —Ä—É—á–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏
‚¨ú [ARCH-4] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å handleCaptureWithPosition –∏ handleCaptureFromFrozenFrame –≤ –µ–¥–∏–Ω—ã–π capture workflow
```

### 10.3 –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ GalleryPage  
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/gallery/index.tsx` (642 —Å—Ç—Ä–æ–∫–∏)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ö—É–∫–æ–≤, —Ñ–∞–π–ª –æ—Å—Ç–∞—ë—Ç—Å—è –±–æ–ª—å—à–∏–º. –ú–Ω–æ–≥–æ JSX —Ä–∞–∑–º–µ—Ç–∫–∏ –∏ inline –ª–æ–≥–∏–∫–∏.

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ò–∑–≤–ª–µ—á—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (GalleryToolbar, GalleryContent).

```
‚¨ú [ARCH-5] [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] –ò–∑–≤–ª–µ—á—å GalleryToolbar –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –ø–∞–Ω–µ–ª–∏ –¥–µ–π—Å—Ç–≤–∏–π
‚¨ú [ARCH-6] [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] –ò–∑–≤–ª–µ—á—å GalleryContent –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
```

### 10.4 –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ throttle/debounce –ª–æ–≥–∏–∫–∏ –≤ —Å–µ–Ω—Å–æ—Ä–Ω—ã—Ö —Ö—É–∫–∞—Ö
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** 
- `client/src/hooks/use-geolocation.ts` (threshold-based updates)
- `client/src/hooks/use-orientation.ts` (throttle + significant change detection)

**–ü—Ä–æ–±–ª–µ–º–∞:** –û–±–∞ —Ö—É–∫–∞ —Ä–µ–∞–ª–∏–∑—É—é—Ç –ø–æ—Ö–æ–∂–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω:
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ ref
- –ü–æ—Ä–æ–≥ –∑–Ω–∞—á–∏–º–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è (threshold)
- Throttling –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- Cleanup –ø–æ–¥–ø–∏—Å–æ–∫

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –æ–±—â–∏–π —Ö—É–∫ `useSensorWithThreshold` –¥–ª—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ª–æ–≥–∏–∫–∏.

```
‚¨ú [DUP-5] [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π —Ö—É–∫ useSensorWithThreshold
‚¨ú [DUP-6] [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å use-orientation.ts –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ —Ö—É–∫–∞
```

### 10.5 Barrel exports –≤ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/components/ui/` (50+ —Ñ–∞–π–ª–æ–≤)

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç barrel file (index.ts) –¥–ª—è UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –¥–ª–∏–Ω–Ω—ã–º –ø—É—Ç—è–º –∏–º–ø–æ—Ä—Ç–∞.

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å index.ts –¥–ª—è –Ω–∞–∏–±–æ–ª–µ–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

```
‚¨ú [IMP-1] [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] –°–æ–∑–¥–∞—Ç—å client/src/components/ui/index.ts —Å —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç–æ–º –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```

### 10.6 ESLint –ø—Ä–æ–±–ª–µ–º—ã (–¥–µ–∫–∞–±—Ä—å 2025)
**–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** 07.12.2025

#### Console.log –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –∫–æ–¥–µ
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/camera/components/CameraViewfinder.tsx`

- –°—Ç—Ä–æ–∫–∞ 172: `console.log('[LongPress] screen:', screenPosition, 'video:', videoPosition, 'params:', params);`
- –°—Ç—Ä–æ–∫–∞ 175: `console.log('[LongPress] no conversion, using screen:', screenPosition);`

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `logger.debug()` –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å

```
‚¨ú [CLEAN-1] –ó–∞–º–µ–Ω–∏—Ç—å console.log –Ω–∞ logger.debug –≤ CameraViewfinder.tsx:172
‚¨ú [CLEAN-2] –ó–∞–º–µ–Ω–∏—Ç—å console.log –Ω–∞ logger.debug –≤ CameraViewfinder.tsx:175
```

#### Unused underscore variables (ESLint warning)
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/lib/db/photo-service.ts`

–ü–∞—Ç—Ç–µ—Ä–Ω –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏–∏ `{ imageData: _, thumbnailData: __ }` –≤—ã–∑—ã–≤–∞–µ—Ç ESLint warning (assigned but never used). –≠—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω TypeScript –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø–æ–ª–µ–π.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å underscore –∫ –∏–º–µ–Ω–∞–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–¥–∞–≤–ª–µ–Ω–∏—è ESLint warning.

```
‚¨ú [CLEAN-3] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å _ ‚Üí _imageData, __ ‚Üí _thumbnailData –≤ photo-service.ts:147
‚¨ú [CLEAN-4] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å _ ‚Üí _imageData –≤ photo-service.ts:174
‚¨ú [CLEAN-5] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å _ ‚Üí _imageData –≤ photo-service.ts:240
```

#### actionTypes warning
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/hooks/use-toast.ts:19`

–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `actionTypes` –æ–±—ä—è–≤–ª–µ–Ω–∞, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∫ —Ç–∏–ø.

**–†–µ—à–µ–Ω–∏–µ:** –£–∂–µ –µ—Å—Ç—å eslint-disable –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, –ø—Ä–æ–±–ª–µ–º–∞ –∏–∑–≤–µ—Å—Ç–Ω–∞ –∏ –¥–æ–ø—É—Å—Ç–∏–º–∞.

---

## –ß–µ–∫-–ª–∏—Å—Ç –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á (–¥–µ–∫–∞–±—Ä—å 2024)

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

```
‚¨ú [DUP-3] –ò–∑–≤–ª–µ—á—å –æ–±—â—É—é —Ñ—É–Ω–∫—Ü–∏—é sampleColorFromCanvas –≤ lib/canvas-utils.ts
‚¨ú [DUP-4] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å sampleColorFromVideo/sampleColorFromFrozenFrame –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏
```

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

```
‚¨ú [ARCH-3] –°–æ–∑–¥–∞—Ç—å useAdjustmentMode —Ö—É–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–º —Ä—É—á–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏
‚¨ú [ARCH-4] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å handleCaptureWithPosition –∏ handleCaptureFromFrozenFrame –≤ –µ–¥–∏–Ω—ã–π capture workflow
```

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```
‚¨ú [ARCH-5] –ò–∑–≤–ª–µ—á—å GalleryToolbar –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚¨ú [ARCH-6] –ò–∑–≤–ª–µ—á—å GalleryContent –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚¨ú [DUP-5] –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π —Ö—É–∫ useSensorWithThreshold
‚¨ú [DUP-6] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å use-orientation.ts –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ —Ö—É–∫–∞
‚¨ú [IMP-1] –°–æ–∑–¥–∞—Ç—å barrel export –¥–ª—è UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```

### Clean Code (–¥–µ–∫–∞–±—Ä—å 2025)

```
‚¨ú [CLEAN-1] –ó–∞–º–µ–Ω–∏—Ç—å console.log –Ω–∞ logger.debug –≤ CameraViewfinder.tsx:172
‚¨ú [CLEAN-2] –ó–∞–º–µ–Ω–∏—Ç—å console.log –Ω–∞ logger.debug –≤ CameraViewfinder.tsx:175
‚¨ú [CLEAN-3] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å _ ‚Üí _imageData –≤ photo-service.ts:147
‚¨ú [CLEAN-4] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å _ ‚Üí _imageData –≤ photo-service.ts:174
‚¨ú [CLEAN-5] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å _ ‚Üí _imageData –≤ photo-service.ts:240
```

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã

| –§–∞–π–ª | –°—Ç—Ä–æ–∫–∏ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|--------|-------------|
| client/src/components/ui/sidebar.tsx | 727 | shadcn/ui - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ |
| client/src/pages/gallery/index.tsx | 642 | –õ–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —Ö—É–∫–∏, –æ—Å—Ç–∞—ë—Ç—Å—è JSX |
| client/src/pages/camera/index.tsx | 638 | –¢—Ä–µ–±—É–µ—Ç –¥–∞–ª—å–Ω–µ–π—à–µ–π –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ |
| client/src/pages/camera/components/CameraViewfinder.tsx | 480 | –ü—Ä–∏–µ–º–ª–µ–º–æ |
| client/src/lib/db/photo-service.ts | 459 | –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π |
| client/src/lib/i18n/ru.ts | 426 | –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è |
| client/src/lib/i18n/en.ts | 426 | –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è |
| client/src/pages/settings/index.tsx | 422 | –°–µ–∫—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ |
| client/src/hooks/use-camera.ts | 370 | –•—É–∫ –∫–∞–º–µ—Ä—ã |

---

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –∫–æ–Ω–≤–µ–Ω—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ `client/src/docs/ARCHITECTURE.md`:
- UI Component Patterns (Radix/shadcn, overlayStyles, SettingRow/SettingSlider)
- Custom Hooks Architecture (useTouchTracking, useColorSampling, Gallery hooks)
- Database Layer (Service architecture, cache invalidation)
- Constants (LONG_PRESS, CAMERA, GESTURE, TIMING)
- Performance Patterns (Memoization, Parallel operations, Virtualization)
- State Management (Settings Context, captureConfig memoization)
- Code Organization (File size guidelines, Component structure)
