# TypeScript Project Audit Report

## Summary

This document contains the results of a comprehensive TypeScript project audit covering code duplication, architecture, performance, typing, data handling, async patterns, imports, code smells, and **clean code analysis**.

**–ü–æ—Å–ª–µ–¥–Ω–∏–π –∞—É–¥–∏—Ç:** 08.12.2025

**–°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á —Ä–∞–∑–¥–µ–ª–æ–≤ 1-10:** ‚úÖ –í–°–ï –ó–ê–î–ê–ß–ò –û–ë–†–ê–ë–û–¢–ê–ù–´

**–†–∞–∑–¥–µ–ª 11 (08.12.2025):** ‚úÖ –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ –í–´–ü–û–õ–ù–ï–ù
- –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 5 –∑–∞–¥–∞—á ‚úÖ (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ haptic, color utils)
- –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 3 –∑–∞–¥–∞—á–∏ –æ—Å—Ç–∞–ª–æ—Å—å / 1 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ settings)
- –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 2 –∑–∞–¥–∞—á–∏ (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)

**Clean Code Audit (–†–∞–∑–¥–µ–ª 9):** ‚úÖ –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

**–ó–∞–¥–∞—á–∏ –†–∞–∑–¥–µ–ª–∞ 10:** ‚úÖ –í—Å–µ –∑–∞–¥–∞—á–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã:
- ‚úÖ –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 2 –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (sampleColorFromSource, sampleContrastingColor)
- ‚úÖ –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 2 –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (useAdjustmentMode, capture workflow)
- ‚úÖ Clean Code: 5 –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–æ (console.log ‚Üí logger.debug, underscore variables)
- ‚úÖ Barrel exports: index.ts –¥–ª—è UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚è∏Ô∏è –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 4 –∑–∞–¥–∞—á–∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø—Ä–∏–∑–Ω–∞–Ω—ã –Ω–µ—Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω—ã–º–∏ (—Å–º. –¥–µ—Ç–∞–ª–∏)

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ - –∞–Ω–∞–ª–∏–∑ (07.12.2025):**
- ‚è∏Ô∏è ARCH-5, ARCH-6 (GalleryToolbar/Content): Gallery —É–∂–µ —Ö–æ—Ä–æ—à–æ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ä–æ–≤–∞–Ω, –¥–∞–ª—å–Ω–µ–π—à–µ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–æ–±–∞–≤–∏—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å
- ‚è∏Ô∏è DUP-5, DUP-6 (useSensorWithThreshold): –•—É–∫–∏ –∏–º–µ—é—Ç <10% –æ–±—â–µ–≥–æ –∫–æ–¥–∞, –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è —É—Ö—É–¥—à–∏—Ç —á–∏—Ç–∞–µ–º–æ—Å—Ç—å

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–µ—Ä–≤–µ—Ä–Ω—ã–π –ª–æ–≥–≥–µ—Ä (server/logger.ts) - —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ ESLint –ø—Ä–∞–≤–∏–ª–æ no-console - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å console.log
- ‚úÖ useAdjustmentMode —Ö—É–∫ - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–º —Ä—É—á–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏
- ‚úÖ sampleColorFromSource - –æ–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è color sampling –≤ canvas-utils.ts
- ‚úÖ CameraPage —É–º–µ–Ω—å—à–µ–Ω —Å 638 –¥–æ 489 —Å—Ç—Ä–æ–∫

---

## 1. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–≤—Ç–æ—Ä—ã

### 1.1 –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—É–∫–æ–≤ –∂–µ—Å—Ç–æ–≤
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/hooks/use-gestures.ts` –∏ `client/src/hooks/use-long-press.ts`

**–ü—Ä–æ–±–ª–µ–º–∞:** –û–±–∞ —Ö—É–∫–∞ –∏–º–µ—é—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è:
- –û–±—Ä–∞–±–æ—Ç–∫–∏ long press —Å —Ç–∞–π–º–µ—Ä–æ–º
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ –∫–∞—Å–∞–Ω–∏—è
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –¥–ª—è –æ—Ç–º–µ–Ω—ã long press
- ~~–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã `DEFAULT_LONG_PRESS_DELAY = 500` –∏ `DEFAULT_MOVE_THRESHOLD = 10`~~

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –ò–∑–≤–ª–µ—á—å –æ–±—â—É—é –ª–æ–≥–∏–∫—É –≤ –±–∞–∑–æ–≤—ã–π —Ö—É–∫ –∏–ª–∏ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–°–æ–∑–¥–∞–Ω –±–∞–∑–æ–≤—ã–π —Ö—É–∫ `useTouchTracking` –≤ `client/src/hooks/use-touch-tracking.ts`:
- –û–±—â–∞—è –ª–æ–≥–∏–∫–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–∞—Å–∞–Ω–∏–π
- –¢–∞–π–º–µ—Ä long press —Å –æ—á–∏—Å—Ç–∫–æ–π
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ moveThreshold –¥–ª—è –æ—Ç–º–µ–Ω—ã

```
‚úÖ –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π —Ö—É–∫ useTouchTracking —Å –æ–±—â–µ–π –ª–æ–≥–∏–∫–æ–π
‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å use-gestures.ts –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ —Ö—É–∫–∞
‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å use-long-press.ts –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ —Ö—É–∫–∞
‚úÖ –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –æ–±—â–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –≤ constants.ts (LONG_PRESS.DEFAULT_DELAY_MS, LONG_PRESS.DEFAULT_MOVE_THRESHOLD_PX)
```

### 1.2 –ü–∞—Ç—Ç–µ—Ä–Ω UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Radix
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/components/ui/` (alert-dialog.tsx, dialog.tsx, drawer.tsx, dropdown-menu.tsx, sheet.tsx, popover.tsx, select.tsx, toast.tsx, tooltip.tsx –∏ –¥—Ä.)

**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–ª–µ–¥—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º—É —à–∞–±–ª–æ–Ω—É:
- forwardRef wrapper
- cn() –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤
- displayName –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ
- Overlay —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏ `bg-black/80`

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω shadcn/ui, –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –ù–æ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å helper –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å—Ç–∏–ª–µ–π overlay.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–°–æ–∑–¥–∞–Ω `client/src/components/ui/styles.ts`:
- `overlayStyles` - –æ–±—â–∏–µ —Å—Ç–∏–ª–∏ overlay –∞–Ω–∏–º–∞—Ü–∏–π
- `dialogContentStyles` - —Å—Ç–∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–∏–∞–ª–æ–≥–æ–≤
- `dialogCloseButtonStyles` - —Å—Ç–∏–ª–∏ –∫–Ω–æ–ø–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è
- `dialogHeaderStyles` - —Å—Ç–∏–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤
- `dialogFooterStyles` - —Å—Ç–∏–ª–∏ —Ñ—É—Ç–µ—Ä–∞ –¥–∏–∞–ª–æ–≥–æ–≤

–û–±–Ω–æ–≤–ª–µ–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `alert-dialog.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç overlayStyles –∏ dialogContentStyles
- `dialog.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç overlayStyles, dialogContentStyles, dialogCloseButtonStyles
- `sheet.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç overlayStyles –∏ dialogCloseButtonStyles

```
‚úÖ [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] –°–æ–∑–¥–∞—Ç—å –æ–±—â–∏–π overlayStyles constant –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∫–ª–∞—Å—Å–æ–≤ –∞–Ω–∏–º–∞—Ü–∏–π
‚úÖ [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω –≤ ARCHITECTURE.md –¥–ª—è onboarding –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
```

### 1.3 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Settings Sections
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/settings/sections/*.tsx`

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–µ–∫—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–º–µ—é—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â—É—é—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É:
- CollapsibleCard wrapper
- Label —Å –∏–∫–æ–Ω–∫–æ–π
- Switch/Slider –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- Separator –º–µ–∂–¥—É —Å–µ–∫—Ü–∏—è–º–∏

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —Ç–∏–ø–∏—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –Ω–∞—Å—Ç—Ä–æ–µ–∫.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–°–æ–∑–¥–∞–Ω—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `client/src/components/ui/setting-row.tsx` - –¥–ª—è label + switch/control
- `client/src/components/ui/setting-slider.tsx` - –¥–ª—è slider —Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º label –∏ value display

–†–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω—ã —Å–µ–∫—Ü–∏–∏:
- `GeneralSettingsSection.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SettingRow
- `CameraSettingsSection.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SettingRow –∏ SettingSlider
- `ReticleSection.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SettingRow –∏ SettingSlider
- `ImageQualitySection.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SettingRow –∏ SettingSlider
- `WatermarkSection.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SettingRow –∏ SettingSlider

```
‚úÖ –°–æ–∑–¥–∞—Ç—å SettingRow –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è label + switch/slider
‚úÖ –°–æ–∑–¥–∞—Ç—å SettingSlider –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º label –∏ value display
‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ–∫—Ü–∏–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (GeneralSettingsSection, CameraSettingsSection)
‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (ReticleSection, ImageQualitySection, WatermarkSection)
```

---

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### 2.1 –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** 
- `client/src/pages/gallery/index.tsx` (~~636 —Å—Ç—Ä–æ–∫~~ ‚Üí 643 —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)
- `client/src/pages/camera/index.tsx` (~~401 —Å—Ç—Ä–æ–∫–∞~~ ‚Üí ~350 —Å—Ç—Ä–æ–∫ –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)

**–ü—Ä–æ–±–ª–µ–º–∞:** ~~–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ª–æ–≥–∏–∫–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π~~

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ß–ê–°–¢–ò–ß–ù–û –í–´–ü–û–õ–ù–ï–ù–û

GalleryPage —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ö—É–∫–∏:
- `useGallerySelection` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º
- `useGalleryView` - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–æ–≤ –∏ –ø–∞–ø–æ–∫
- `useGalleryFilters` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
- `useGalleryPhotos` - –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è —Ñ–æ—Ç–æ
- `useUploadHandler` - –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –æ–±–ª–∞–∫–æ
- `useLinksDialog` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–æ–º —Å—Å—ã–ª–æ–∫

CameraPage —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
- `useColorSampling` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ –ø—Ä–∏—Ü–µ–ª–∞
- `useCaptureController` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å—ä—ë–º–∫–∏ —á–µ—Ä–µ–∑ useReducer

```
‚úÖ –ò–∑–≤–ª–µ—á—å useUploadHandler –∏–∑ GalleryPage
‚úÖ –ò–∑–≤–ª–µ—á—å useGalleryDialogs –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –¥–∏–∞–ª–æ–≥–æ–≤ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–∞–∫ useLinksDialog + useGallerySelection)
‚úÖ –ò–∑–≤–ª–µ—á—å ColorSamplingProvider –∏–ª–∏ —Ö—É–∫ –∏–∑ CameraPage (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–∞–∫ useColorSampling)
‚úÖ useCaptureController —Å useReducer - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π lifecycle
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è useCaptureController:**
- `CAPTURE_START` ‚Üí `{isCapturing: true, isProcessing: false}`
- `CAPTURE_SUCCESS` ‚Üí `{isCapturing: false, isProcessing: true}`
- `CAPTURE_FAILED` ‚Üí `{isCapturing: false, isProcessing: false}` - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—á–∏—â–∞–µ—Ç –æ–±–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `PROCESSING_COMPLETE` ‚Üí `{isCapturing: false, isProcessing: false}`
- `ABORT` ‚Üí `{isCapturing: false, isProcessing: false}` - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—á–∏—â–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π cleanup AbortController –≤ useEffect

### 2.2 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–ª–æ—è —Å–µ—Ä–≤–∏—Å–æ–≤
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** ~~`client/src/lib/db.ts` (705 —Å—Ç—Ä–æ–∫)~~ ‚Üí `client/src/lib/db/`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ–ø–µ—Ä—å:
```
client/src/lib/db/
‚îú‚îÄ‚îÄ db-core.ts        # –ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ IndexedDB, openDB, generateId, –∫–µ—à —Å –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
‚îú‚îÄ‚îÄ photo-service.ts  # –û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏
‚îú‚îÄ‚îÄ folder-service.ts # –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–∞–ø–∫–∞–º–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
‚îú‚îÄ‚îÄ settings-service.ts # –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
‚îú‚îÄ‚îÄ storage-service.ts  # –£—Ç–∏–ª–∏—Ç—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è
‚îî‚îÄ‚îÄ index.ts          # –†–µ—ç–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
```

```
‚úÖ –°–æ–∑–¥–∞—Ç—å client/src/lib/db/photo-service.ts –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ —Ñ–æ—Ç–æ
‚úÖ –°–æ–∑–¥–∞—Ç—å client/src/lib/db/settings-service.ts –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å –≤ db-core.ts —Ç–æ–ª—å–∫–æ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å IndexedDB
‚úÖ –°–æ–∑–¥–∞—Ç—å folder-service.ts –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–∞–ø–∫–∞–º–∏
‚úÖ –°–æ–∑–¥–∞—Ç—å storage-service.ts –¥–ª—è —É—Ç–∏–ª–∏—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è
```

---

## 3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 3.1 –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ await –≤–º–µ—Å—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/camera/index.tsx` —Å—Ç—Ä–æ–∫–∏ 78-98

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–¢–µ–∫—É—â–∏–π –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Promise.all`:
```typescript
const [counts, latest] = await Promise.all([
  getPhotoCounts(),
  getLatestPhoto(),
]);
```

```
‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å loadPhotos –≤ camera/index.tsx –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```

### 3.2 –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/gallery/index.tsx` —Å—Ç—Ä–æ–∫–∏ 226-263

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–¢–µ–∫—É—â–∏–π –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Promise.all` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏:
```typescript
const imageDataResults = await Promise.all(
  selectedPhotos.map(async (photo) => {
    const imageData = await getPhotoImageData(photo.id);
    const blob = await createCleanImageBlob(imageData);
    return { photo, blob };
  })
);
```

```
‚úÖ –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∏—Ç—å imageData –¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ Promise.all
‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞
‚úÖ –£–¥–∞–ª–µ–Ω–∞ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
```

### 3.3 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ–º–æ–∏–∑–∞—Ü–∏–∏ –≤ PhotoListItem –∏ PhotoGridCell
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** ~~`client/src/components/virtualized-gallery.tsx`~~ ‚Üí `client/src/components/virtualized-gallery/`

**–ü—Ä–æ–±–ª–µ–º–∞:** ~~–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ callback —Ñ—É–Ω–∫—Ü–∏–∏ `handleLongPress` –∏ `handleClick` —Å–æ–∑–¥–∞—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ memo wrapper.~~

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

- `handleClick` —Ç–µ–ø–µ—Ä—å –æ–±—ë—Ä–Ω—É—Ç –≤ `useCallback` –≤ –æ–±–æ–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- `handleLongPress` —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `useCallback`
- `data` –¥–ª—è longPressHandlers - –ø—Ä–∏–º–∏—Ç–∏–≤ (string), –º–µ–º–æ–∏–∑–∞—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

```
‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å useCallback –¥–ª—è handleClick –≤ PhotoListItemBase –∏ PhotoGridCellBase
‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ useCallback –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
```

### 3.4 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ debounce –¥–ª—è color sampling
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/camera/index.tsx` —Å—Ç—Ä–æ–∫–∏ 130-208

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `previousColorRef` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ª–∏—à–Ω–∏—Ö —Ä–µ—Ä–µ–Ω–¥–µ—Ä–æ–≤:
```typescript
const previousColorRef = useRef<string>(CAMERA.DEFAULT_RETICLE_COLOR);
// ...
const newColor = getContrastingColor(r, g, b, colorScheme);
if (newColor !== previousColorRef.current) {
  previousColorRef.current = newColor;
  setReticleColor(newColor);
}
```

```
‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ü–≤–µ—Ç–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø–µ—Ä–µ–¥ setReticleColor
‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å useRef –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ü–≤–µ—Ç–∞
```

---

## 4. –¢–∏–ø–∏–∑–∞—Ü–∏—è

### 4.1 –°—Ç–∞—Ç—É—Å —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** ‚úÖ –û—Ç–ª–∏—á–Ω–æ

- –ù–µ –Ω–∞–π–¥–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `any` —Ç–∏–ø–æ–≤
- –ù–µ –Ω–∞–π–¥–µ–Ω–æ `@ts-ignore` –∏–ª–∏ `@ts-nocheck` –¥–∏—Ä–µ–∫—Ç–∏–≤
- –¢–∏–ø—ã —Ö–æ—Ä–æ—à–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `shared/schema.ts`

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - —Ç–∏–ø–∏–∑–∞—Ü–∏—è –≤ —Ö–æ—Ä–æ—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
```

---

## 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### 5.1 –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/lib/db/folder-service.ts` —Ñ—É–Ω–∫—Ü–∏—è `getFolderStats`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ—Ö–æ–¥ –ø–æ –≤—Å–µ–º –∑–∞–ø–∏—Å—è–º –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ (—Å TTL –∫–µ—à–µ–º).

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:** –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–∏ –º—É—Ç–∞—Ü–∏—è—Ö.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–∞:
- `updateCacheOnPhotoAdd()` - –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–µ—à –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ñ–æ—Ç–æ
- `updateCacheOnPhotoDelete()` - –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–µ—à –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–æ—Ç–æ
- `updateCacheOnPhotoUpload()` - –æ–±–Ω–æ–≤–ª—è–µ—Ç uploadedCount –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤ –æ–±–ª–∞–∫–æ
- `invalidateFolderCountsCache()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ clearAllPhotos –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞
- TTL –∫–µ—à–∞ 30 —Å–µ–∫—É–Ω–¥

```
‚úÖ [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] –£–≤–µ–ª–∏—á–∏—Ç—å TTL –∫–µ—à–∞ –µ—Å–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–¥–∫–æ –º–µ–Ω—è–µ—Ç—Å—è (5—Å ‚Üí 30—Å)
‚úÖ –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–∞ - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –∫–µ—à–∞:**
- `savePhoto()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `updateCacheOnPhotoAdd(folder, thumbnailData, timestamp, isUploaded)`
- `deletePhoto()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `updateCacheOnPhotoDelete(folder, wasUploaded, wasLatestInFolder)` —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π latestTimestamp
- `updatePhoto()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `updateCacheOnFolderChange()` –ø—Ä–∏ —Å–º–µ–Ω–µ –ø–∞–ø–∫–∏, –∏–ª–∏ `updateCacheOnPhotoUpload(folder)` –ø—Ä–∏ –Ω–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ
- `clearAllPhotos()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `invalidateFolderCountsCache()` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞

**–ì–∞—Ä–∞–Ω—Ç–∏–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏:**
- –ò–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å: –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç –Ω–æ–≤—ã–µ Map/–º–∞—Å—Å–∏–≤—ã –ø–µ—Ä–µ–¥ –º—É—Ç–∞—Ü–∏–µ–π
- –°–º–µ–Ω–∞ –ø–∞–ø–∫–∏: –ø–æ–ª–Ω–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–µ—à–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–µ—Ä–µ—Å—á—ë—Ç–∞
- –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ñ–æ—Ç–æ –ø–∞–ø–∫–∏: –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è folderStatsCache –¥–ª—è –ø–µ—Ä–µ—Å—á—ë—Ç–∞ latestThumb
- –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω–æ–≥–æ increment: updatePhoto –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `!wasUploaded && isNowUploaded`

---

## 6. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å

### 6.1 –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AbortController
**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** ‚úÖ –•–æ—Ä–æ—à–æ

–ù–∞–π–¥–µ–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AbortController:
- `client/src/hooks/use-photo-navigator.ts` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π cleanup
- `client/src/lib/capture-helpers.ts` - –ø—Ä–æ–≤–µ—Ä–∫–∞ signal.aborted
- `client/src/pages/gallery/index.tsx` - upload cancellation

### 6.2 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ debounce –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/lib/settings-context.tsx`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ - debounce —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (—Å—Ç—Ä–æ–∫–∞ 27)

### 6.3 Throttle –¥–ª—è orientation
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/hooks/use-orientation.ts`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ - throttle —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (—Å—Ç—Ä–æ–∫–∏ 91-99)

```
‚úÖ –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á –ø–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏
```

---

## 7. –ò–º–ø–æ—Ä—Ç—ã –∏ –±–∞–Ω–¥–ª

### 7.1 Lazy Loading
**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

Lazy loading –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ `client/src/App.tsx`:
- CameraPage, GalleryPage, PhotoDetailPage, SettingsPage, GamePage - –≤—Å–µ lazy loaded

### 7.2 Virtualization
**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

–í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ `client/src/components/virtualized-gallery.tsx` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º react-window.

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - code splitting –∏ virtualization –≤ —Ö–æ—Ä–æ—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
```

---

## 8. –ö–æ–¥-—Å–º–µ–ª–ª—ã

### 8.1 –î–ª–∏–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–µ–Ω–æ

- ~~`client/src/lib/db.ts` - 705 —Å—Ç—Ä–æ–∫~~ ‚Üí –†–∞–∑–±–∏—Ç –Ω–∞ –º–æ–¥—É–ª–∏ –≤ `client/src/lib/db/`
- `client/src/pages/gallery/index.tsx` - 643 —Å—Ç—Ä–æ–∫–∏ (–ª–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —Ö—É–∫–∏)
- ~~`client/src/components/virtualized-gallery.tsx` - 467 —Å—Ç—Ä–æ–∫~~ ‚Üí –†–∞–∑–±–∏—Ç –Ω–∞ –º–æ–¥—É–ª–∏ –≤ `client/src/components/virtualized-gallery/`
- `client/src/pages/camera/index.tsx` - ~350 —Å—Ç—Ä–æ–∫ (–ª–æ–≥–∏–∫–∞ color sampling –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ useColorSampling)

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ virtualized-gallery:
```
client/src/components/virtualized-gallery/
‚îú‚îÄ‚îÄ types.ts              # –û–±—â–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
‚îú‚îÄ‚îÄ VirtualizedList.tsx   # PhotoListItem + VirtualizedPhotoList
‚îú‚îÄ‚îÄ VirtualizedGrid.tsx   # PhotoGridCell + VirtualizedPhotoGrid
‚îú‚îÄ‚îÄ AutoSizerContainer.tsx # AutoSizerContainer
‚îî‚îÄ‚îÄ index.ts              # –†–µ—ç–∫—Å–ø–æ—Ä—Ç
```

```
‚úÖ –†–∞–∑–±–∏—Ç—å db.ts –Ω–∞ –º–æ–¥—É–ª–∏ (—Å–º. —Ä–∞–∑–¥–µ–ª 2.2)
‚úÖ –†–∞–∑–±–∏—Ç—å gallery/index.tsx - –ª–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —Ö—É–∫–∏
‚úÖ –†–∞–∑–±–∏—Ç—å virtualized-gallery.tsx –Ω–∞ VirtualizedList –∏ VirtualizedGrid —Ñ–∞–π–ª—ã
```

### 8.2 –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞
**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** ‚úÖ –•–æ—Ä–æ—à–æ

–ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ `client/src/lib/constants.ts`:
- TIMING, GESTURE, GAME, UPLOAD, STORAGE_KEYS, PATTERN_LOCK, IMAGE, SENSORS, CAMERA, GALLERY, UI, LONG_PRESS

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û - `CAMERA.DEFAULT_RETICLE_SIZE` –¥–æ–±–∞–≤–ª–µ–Ω –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
```typescript
const sizePercent = settings.reticle.size || CAMERA.DEFAULT_RETICLE_SIZE;
```

```
‚úÖ –î–æ–±–∞–≤–∏—Ç—å DEFAULT_RETICLE_SIZE –≤ constants.ts
‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å hardcoded –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É
```

### 8.3 –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ useCallback
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/camera/index.tsx` —Å—Ç—Ä–æ–∫–∞ 271

**–ü—Ä–æ–±–ª–µ–º–∞:** ~~handleCapture –∏–º–µ–µ—Ç –º–Ω–æ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –º–∞—Å—Å–∏–≤–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.~~

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ß–ê–°–¢–ò–ß–ù–û –í–´–ü–û–õ–ù–ï–ù–û

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:
- `captureConfig` –æ–±—ä–µ–∫—Ç —á–µ—Ä–µ–∑ `useMemo` –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- Inline state management —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

```
‚úÖ –°–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç captureConfig –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚úÖ useCaptureController —Å useReducer - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π lifecycle
```

### 8.4 Cleanup —Ñ—É–Ω–∫—Ü–∏–∏ –≤ useEffect
**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:** ‚úÖ –•–æ—Ä–æ—à–æ

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ useEffect hooks –∏–º–µ—é—Ç cleanup —Ñ—É–Ω–∫—Ü–∏–∏:
- `use-camera.ts` - stopCamera cleanup
- `use-orientation.ts` - removeEventListener + clearTimeout
- `use-stabilization.ts` - cancelAnimationFrame
- `use-photo-navigator.ts` - AbortController abort
- `use-gestures.ts` - clearLongPressTimer
- `use-capture-controller.ts` - AbortController abort (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π cleanup)

---

## –ß–µ–∫-–ª–∏—Å—Ç –∑–∞–¥–∞—á –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

```
‚úÖ [PERF-1] –ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–æ–≤–∞—Ç—å getPhotoCounts() –∏ getLatestPhoto() –≤ camera/index.tsx
‚úÖ [PERF-2] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å handleDownloadSelected –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚úÖ [PERF-3] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–≤–µ—Ç–∞ –ø–µ—Ä–µ–¥ setReticleColor
‚úÖ [ARCH-1] –†–∞–∑–±–∏—Ç—å db.ts –Ω–∞ photo-service.ts, settings-service.ts, folder-service.ts, storage-service.ts –∏ db-core.ts
‚úÖ [ARCH-2] –ò–∑–≤–ª–µ—á—å —Ö—É–∫–∏ –∏–∑ GalleryPage (useUploadHandler, useGallerySelection, useGalleryFilters, useGalleryPhotos, useGalleryView, useLinksDialog)
```

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥)

```
‚úÖ [DUP-1] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É use-gestures.ts –∏ use-long-press.ts (—Å–æ–∑–¥–∞—Ç—å useTouchTracking)
‚úÖ [DUP-2] –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –æ–±—â–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã DEFAULT_LONG_PRESS_DELAY, DEFAULT_MOVE_THRESHOLD –≤ constants.ts
‚úÖ [REF-1] –°–æ–∑–¥–∞—Ç—å –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã SettingRow –∏ SettingSlider
‚úÖ [REF-2] –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ handleCapture –≤ captureConfig –æ–±—ä–µ–∫—Ç
```

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è)

```
‚úÖ [OPT-1] –î–æ–±–∞–≤–∏—Ç—å DEFAULT_RETICLE_SIZE –≤ constants.ts
‚úÖ [OPT-2] –£–≤–µ–ª–∏—á–∏—Ç—å TTL –∫–µ—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–∞–ø–æ–∫ (5—Å ‚Üí 30—Å)
‚úÖ [OPT-3] –†–∞–∑–±–∏—Ç—å virtualized-gallery.tsx –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
‚úÖ [OPT-4] –°–æ–∑–¥–∞—Ç—å overlayStyles constant –¥–ª—è UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚úÖ [OPT-5] –ò–∑–≤–ª–µ—á—å useColorSampling —Ö—É–∫ –∏–∑ CameraPage
‚úÖ [OPT-6] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ ARCHITECTURE.md
‚úÖ [OPT-7] useCaptureController —Å useReducer - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π lifecycle
‚úÖ [OPT-8] –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

---

## –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞

1. ‚úÖ **–¢–∏–ø–∏–∑–∞—Ü–∏—è** - –û—Ç–ª–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TypeScript –±–µ–∑ any –∏ ts-ignore
2. ‚úÖ **Lazy Loading** - –ü—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å—Ç—Ä–∞–Ω–∏—Ü
3. ‚úÖ **Virtualization** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ react-window –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏
4. ‚úÖ **Constants** - –ú–∞–≥–∏—á–µ—Å–∫–∏–µ —á–∏—Å–ª–∞ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ constants.ts
5. ‚úÖ **Error Handling** - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ async –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
6. ‚úÖ **AbortController** - –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–º–µ–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–π
7. ‚úÖ **Debounce/Throttle** - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≥–¥–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
8. ‚úÖ **Cleanup** - useEffect hooks –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ cleanup —Ñ—É–Ω–∫—Ü–∏–∏
9. ‚úÖ **i18n** - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
10. ‚úÖ **Memo** - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ React.memo –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
11. ‚úÖ **Service Layer** - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ db.ts –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
12. ‚úÖ **Custom Hooks** - –•–æ—Ä–æ—à–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –ª–æ–≥–∏–∫–∏ GalleryPage –≤ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ö—É–∫–∏
13. ‚úÖ **Shared Touch Tracking** - –ë–∞–∑–æ–≤—ã–π —Ö—É–∫ useTouchTracking –¥–ª—è –æ–±—â–µ–π –ª–æ–≥–∏–∫–∏ –∂–µ—Å—Ç–æ–≤
14. ‚úÖ **Reusable Settings Components** - SettingRow –∏ SettingSlider –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
15. ‚úÖ **Grouped Dependencies** - captureConfig –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π handleCapture
16. ‚úÖ **Memoized Callbacks** - handleClick –æ–±—ë—Ä–Ω—É—Ç –≤ useCallback –≤ virtualized-gallery
17. ‚úÖ **Modular Gallery Components** - virtualized-gallery —Ä–∞–∑–±–∏—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
18. ‚úÖ **Architecture Documentation** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤ ARCHITECTURE.md
19. ‚úÖ **Capture State Machine** - useCaptureController —Å useReducer –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å—ä—ë–º–∫–∏
20. ‚úÖ **Incremental Cache** - –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–µ—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–∞–ø–æ–∫ –±–µ–∑ –ø–æ–ª–Ω–æ–π –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏

---

## 9. –ê–Ω–∞–ª–∏–∑ —á–∏—Å—Ç–æ—Ç—ã –∫–æ–¥–∞ (Clean Code Audit)

### 9.1 –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û

ESLint —Å –ø–ª–∞–≥–∏–Ω–æ–º `unused-imports` –Ω–µ –≤—ã—è–≤–∏–ª –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ.

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
```

### 9.2 –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û

TypeScript –∏ ESLint –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–µ –≤—ã—è–≤–∏–ª–∏ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

**–ü–∞—Ç—Ç–µ—Ä–Ω —Å underscore –¥–ª—è –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è:**
–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏–∏ —Å underscore –¥–ª—è –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ–≥–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π:
- `client/src/lib/db/photo-service.ts:132` - `const { imageData: _, thumbnailData: __, ...summary } = photo;`
- `client/src/lib/db/photo-service.ts:159` - `const { imageData: _, ...withThumbnail } = photo;`
- `client/src/lib/db/photo-service.ts:225` - `const { imageData: _, ...withThumbnail } = photo;`

–≠—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω TypeScript –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø–æ–ª–µ–π –ø—Ä–∏ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏–∏.

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - –ø–∞—Ç—Ç–µ—Ä–Ω —Å underscore –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

### 9.3 –ú—ë—Ä—Ç–≤—ã–π –∫–æ–¥
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û

- –ù–µ–¥–æ—Å—Ç–∏–∂–∏–º—ã–π –∫–æ–¥ –ø–æ—Å–ª–µ return/throw/break - –Ω–µ –Ω–∞–π–¥–µ–Ω
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –º–µ—Ç–æ–¥—ã - –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ - –Ω–µ –Ω–∞–π–¥–µ–Ω (—Ç–æ–ª—å–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏)

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - –º—ë—Ä—Ç–≤—ã–π –∫–æ–¥ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
```

### 9.4 –ò–∑–±—ã—Ç–æ—á–Ω—ã–π –∫–æ–¥
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û

- –ü—É—Å—Ç—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ —Ç–∏–ø—ã - –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ - –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è (if true/false) - –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- –ù–µ–Ω—É–∂–Ω—ã–µ else –ø–æ—Å–ª–µ return - –Ω–µ –Ω–∞–π–¥–µ–Ω—ã

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - –∏–∑–±—ã—Ç–æ—á–Ω—ã–π –∫–æ–¥ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
```

### 9.5 –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–∏–ø—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û

–í—Å–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ –∏ –Ω–µ—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ —Ç–∏–ø—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∫–æ–¥–µ.

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - –≤—Å–µ —Ç–∏–ø—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
```

### 9.6 –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –ª–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π –∫–æ–¥
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ö–û–†–†–ï–ö–¢–ù–û

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ:**
- `client/src/lib/logger.ts:36-77` - console.debug/info/warn/error - **–ù–ê–ú–ï–†–ï–ù–ù–û** (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä)
- `server/index.ts:54` - console.log - **–ù–ê–ú–ï–†–ï–ù–ù–û** (—Å–µ—Ä–≤–µ—Ä–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤)
- `client/src/docs/ARCHITECTURE.md:84` - console.log - **–î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø** (–ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞)

–í—Å–µ console.* –≤—ã–∑–æ–≤—ã –ª–∏–±–æ —è–≤–ª—è—é—Ç—Å—è —á–∞—Å—Ç—å—é —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –ª–∏–±–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è. Debugger statements –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã.

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

### 9.7 –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ type assertions
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ï –û–ë–ù–ê–†–£–ñ–ï–ù–û

- `as any` - –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∏ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
- `@ts-ignore` / `@ts-nocheck` / `@ts-expect-error` - –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- –ù–µ–Ω—É–∂–Ω—ã–µ type assertions - –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã

```
‚úÖ –ù–µ—Ç –∑–∞–¥–∞—á - type assertions –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

---

## –ß–µ–∫-–ª–∏—Å—Ç –∑–∞–¥–∞—á –¥–ª—è Clean Code Audit

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–±–ª–µ–º—ã |
|----------|--------|----------|
| –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| –ú—ë—Ä—Ç–≤—ã–π –∫–æ–¥ | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| –ü—É—Å—Ç—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã/—Ç–∏–ø—ã | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è —Ç–∏–ø—ã | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–∏–ø—ã | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| Console.log (–∫—Ä–æ–º–µ –ª–æ–≥–≥–µ—Ä–∞) | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| Debugger statements | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| @ts-ignore/@ts-nocheck | ‚úÖ –ß–∏—Å—Ç–æ | 0 |
| as any | ‚úÖ –ß–∏—Å—Ç–æ | 0 |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```
‚úÖ [REC-1] –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é server/index.ts console.log –Ω–∞ –æ–±—â–∏–π logger
    –§–∞–π–ª: server/logger.ts (—Å–æ–∑–¥–∞–Ω), server/index.ts (–æ–±–Ω–æ–≤–ª—ë–Ω)
    –†–µ–∞–ª–∏–∑–∞—Ü–∏—è: –°–æ–∑–¥–∞–Ω —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –ª–æ–≥–≥–µ—Ä —Å –º–µ—Ç–æ–¥–∞–º–∏ debug/info/warn/error/log
    –°—Ç–∞—Ç—É—Å: –í–´–ü–û–õ–ù–ï–ù–û

‚úÖ [REC-2] –î–æ–±–∞–≤–∏—Ç—å ESLint –ø—Ä–∞–≤–∏–ª–æ no-console –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è
    –§–∞–π–ª: eslint.config.js
    –†–µ–∞–ª–∏–∑–∞—Ü–∏—è: –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–æ "no-console": ["warn", { allow: ["warn", "error"] }]
    –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è —Ñ–∞–π–ª–æ–≤ **/logger.ts
    –°—Ç–∞—Ç—É—Å: –í–´–ü–û–õ–ù–ï–ù–û
```

---

## 10. –ê—É–¥–∏—Ç –¥–µ–∫–∞–±—Ä—å 2024

### 10.1 –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ color sampling
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** 
- `client/src/hooks/use-color-sampling.ts` (–æ—Å–Ω–æ–≤–Ω–æ–π —Ö—É–∫)
- `client/src/pages/camera/index.tsx` (—Ñ—É–Ω–∫—Ü–∏–∏ `sampleColorFromVideo`)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∞ –æ–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è `sampleColorFromSource()` –≤ `client/src/lib/canvas-utils.ts`:
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `ColorSampleConfig` –¥–ª—è video –∏ image –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –§—É–Ω–∫—Ü–∏–∏-–ø–æ–º–æ—â–Ω–∏–∫–∏ `getSourceDimensions()` –∏ `isSourceReady()`
- –ü—É–±–ª–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `sampleContrastingColor()` –¥–ª—è —É–ø—Ä–æ—â—ë–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- `useColorSampling` –∏ `useAdjustmentMode` –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—â—É—é —Ñ—É–Ω–∫—Ü–∏—é
- `sampleColorFromVideo` –≤ CameraPage –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `sampleContrastingColor`

```
‚úÖ [DUP-3] –ò–∑–≤–ª–µ—á—å –æ–±—â—É—é —Ñ—É–Ω–∫—Ü–∏—é sampleColorFromSource –≤ lib/canvas-utils.ts
‚úÖ [DUP-4] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å sampleColorFromVideo –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ sampleContrastingColor
```

### 10.2 –ë–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä CameraPage
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/camera/index.tsx` (~490 —Å—Ç—Ä–æ–∫ –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

**–†–µ—à–µ–Ω–∏–µ:** –õ–æ–≥–∏–∫–∞ —Ä—É—á–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ö—É–∫:
- `client/src/hooks/use-adjustment-mode.ts` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–º —Ä—É—á–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏
  - `AdjustmentModeState` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ (active, frozenFrame, position)
  - `activateAdjustment()` - –∑–∞—Ö–≤–∞—Ç –∫–∞–¥—Ä–∞ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è —Ä–µ–∂–∏–º–∞
  - `updatePosition()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏—Ü–µ–ª–∞
  - `confirmAdjustment()` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—ä—ë–º–∫–∏
  - `cancelAdjustment()` - –æ—Ç–º–µ–Ω–∞ —Ä–µ–∂–∏–º–∞
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π color sampling –∏–∑ –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω–æ–≥–æ –∫–∞–¥—Ä–∞ —á–µ—Ä–µ–∑ `sampleContrastingColor`

- CameraPage —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
  - `useCaptureController` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å—ä—ë–º–∫–∏
  - `useAdjustmentMode` –¥–ª—è —Ä–µ–∂–∏–º–∞ —Ä—É—á–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏
  - `useColorSampling` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ü–≤–µ—Ç–∞ –ø—Ä–∏—Ü–µ–ª–∞
  - `handleCaptureWithPosition` –∏ `handleCaptureFromFrozenFrame` —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã

```
‚úÖ [ARCH-3] –°–æ–∑–¥–∞—Ç—å useAdjustmentMode —Ö—É–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–º —Ä—É—á–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏
‚úÖ [ARCH-4] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å handleCaptureWithPosition –∏ handleCaptureFromFrozenFrame –≤ –µ–¥–∏–Ω—ã–π capture workflow
```

### 10.3 –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ GalleryPage  
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/gallery/index.tsx` (642 —Å—Ç—Ä–æ–∫–∏)

**–°—Ç–∞—Ç—É—Å:** ‚è∏Ô∏è –û–¢–õ–û–ñ–ï–ù–û (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ê–Ω–∞–ª–∏–∑ (07.12.2025):**
–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ –¥–∞–ª—å–Ω–µ–π—à–µ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω–µ—Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ:

- **GalleryToolbar**: –õ–æ–≥–∏–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π —É–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `GalleryHeader`, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º —Ä–µ–∂–∏–º–æ–≤, –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º –∏ –∑–∞–≥—Ä—É–∑–∫–æ–π. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ GalleryToolbar –ª–∏–±–æ –¥—É–±–ª–∏—Ä—É–µ—Ç wiring —Å–æ—Å—Ç–æ—è–Ω–∏—è, –ª–∏–±–æ —Å–æ–∑–¥–∞—ë—Ç prop-heavy pass-through –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —É–ø—Ä–æ—â–µ–Ω–∏—è.

- **GalleryContent**: –û—Å–Ω–æ–≤–Ω–æ–π `<main>` –±–ª–æ–∫ —è–≤–ª—è–µ—Ç—Å—è switchboard –º–µ–∂–¥—É —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ (`GalleryFolderList`, `GalleryEmptyState`, `VirtualizedPhotoList/Grid`). –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç —É—Å–ª–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã, —Ç—Ä–µ–±—É—è —Ç–µ –∂–µ –ø—Ä–æ–ø—Å—ã.

**–°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è:**
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã: GalleryHeader, GalleryFilters, GalleryEmptyState, GalleryFolderList, GalleryLinksDialog
- –•—É–∫–∏: useGallerySelection, useGalleryView, useGalleryFilters, useGalleryPhotos

```
‚è∏Ô∏è [ARCH-5] [–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø] –ò–∑–≤–ª–µ—á—å GalleryToolbar - –¥–æ–±–∞–≤–∏—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –±–µ–∑ –ø–æ–ª—å–∑—ã
‚è∏Ô∏è [ARCH-6] [–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø] –ò–∑–≤–ª–µ—á—å GalleryContent - –¥–æ–±–∞–≤–∏—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –±–µ–∑ –ø–æ–ª—å–∑—ã
```

### 10.4 –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ throttle/debounce –ª–æ–≥–∏–∫–∏ –≤ —Å–µ–Ω—Å–æ—Ä–Ω—ã—Ö —Ö—É–∫–∞—Ö
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** 
- `client/src/hooks/use-geolocation.ts` (267 —Å—Ç—Ä–æ–∫, threshold-based updates)
- `client/src/hooks/use-orientation.ts` (193 —Å—Ç—Ä–æ–∫–∏, throttle + significant change detection)

**–°—Ç–∞—Ç—É—Å:** ‚è∏Ô∏è –û–¢–õ–û–ñ–ï–ù–û (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ê–Ω–∞–ª–∏–∑ (07.12.2025):**
–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è –Ω–µ—Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–∞:

- **–û–±—â–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã** (—Ç–æ–ª—å–∫–æ –Ω–∞ –≤—ã—Å–æ–∫–æ–º —É—Ä–æ–≤–Ω–µ):
  - `hasSignificantChange` —Ñ—É–Ω–∫—Ü–∏–∏ —Å –ø–æ—Ä–æ–≥–∞–º–∏
  - `lastDataRef` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
  - Throttling –º–µ—Ö–∞–Ω–∏–∑–º—ã

- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑–ª–∏—á–∏—è**:
  - –†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö (OrientationData vs GeolocationData)
  - –†–∞–∑–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π (DeviceOrientationEvent vs Geolocation API)
  - –†–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π (iOS 13+ requestPermission vs —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ geo permissions)
  - Geolocation –∏–º–µ–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã (getCurrentPosition, startWatching, stopWatching)

- **–û—Ü–µ–Ω–∫–∞**:
  - –ì–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π `useSensorWithThreshold` –ø–æ—Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö generics –∏ callback –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
  - –ö–∞–∂–¥—ã–π —Ö—É–∫ –≤—Å—ë —Ä–∞–≤–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—É—é —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—É—é –ª–æ–≥–∏–∫—É
  - –£—Å—Ç—Ä–∞–Ω–µ–Ω–æ –±—É–¥–µ—Ç <10% –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ —É—Ö—É–¥—à–µ–Ω–∏–∏ —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è —Ç—Ä–µ—Ç–∏–π threshold-based sensor hook.

```
‚è∏Ô∏è [DUP-5] [–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø] –°–æ–∑–¥–∞—Ç—å useSensorWithThreshold - –¥–æ–±–∞–≤–∏—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –±–µ–∑ –ø–æ–ª—å–∑—ã
‚è∏Ô∏è [DUP-6] [–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å use-orientation.ts - —Ö—É–∫–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è
```

### 10.5 Barrel exports –≤ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/components/ui/` (50+ —Ñ–∞–π–ª–æ–≤)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω `client/src/components/ui/index.ts` —Å —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç–æ–º 25+ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
- Button, Card, Dialog, Input, Label, Separator, Switch, Slider
- Badge, Select, Tabs, Checkbox, ScrollArea, Skeleton
- Tooltip, Progress, SettingRow, SettingSlider, CollapsibleCard
- Sheet, DropdownMenu, AlertDialog, Alert, Textarea

```
‚úÖ [IMP-1] –°–æ–∑–¥–∞—Ç—å client/src/components/ui/index.ts —Å —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç–æ–º –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```

### 10.6 ESLint –ø—Ä–æ–±–ª–µ–º—ã (–¥–µ–∫–∞–±—Ä—å 2025)
**–ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞:** 07.12.2025

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–û

#### Console.log –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –∫–æ–¥–µ
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/camera/components/CameraViewfinder.tsx`

**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `logger.debug()` —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º (message, data object):
- `logger.debug('[LongPress] coordinate conversion', { screenPosition, videoPosition, params })`
- `logger.debug('[LongPress] no conversion, using screen position', screenPosition)`

```
‚úÖ [CLEAN-1] –ó–∞–º–µ–Ω–∏—Ç—å console.log –Ω–∞ logger.debug –≤ CameraViewfinder.tsx:176
‚úÖ [CLEAN-2] –ó–∞–º–µ–Ω–∏—Ç—å console.log –Ω–∞ logger.debug –≤ CameraViewfinder.tsx:179
```

#### Unused underscore variables (ESLint warning)
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/lib/db/photo-service.ts`

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è ESLint —Å–æ–≥–ª–∞—à–µ–Ω–∏—è–º:
- `{ imageData: _imageData, thumbnailData: _thumbnailData, ...summary }` (—Å—Ç—Ä–æ–∫–∞ 150)
- `{ imageData: _imageData, ...withThumbnail }` (—Å—Ç—Ä–æ–∫–∞ 177)
- `{ imageData: _imageData, ...withThumbnail }` (—Å—Ç—Ä–æ–∫–∞ 243)

```
‚úÖ [CLEAN-3] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å _ ‚Üí _imageData, __ ‚Üí _thumbnailData –≤ photo-service.ts:150
‚úÖ [CLEAN-4] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å _ ‚Üí _imageData –≤ photo-service.ts:177
‚úÖ [CLEAN-5] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å _ ‚Üí _imageData –≤ photo-service.ts:243
```

#### actionTypes warning
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/hooks/use-toast.ts:19`

–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `actionTypes` –æ–±—ä—è–≤–ª–µ–Ω–∞, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∫ —Ç–∏–ø.

**–†–µ—à–µ–Ω–∏–µ:** –£–∂–µ –µ—Å—Ç—å eslint-disable –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, –ø—Ä–æ–±–ª–µ–º–∞ –∏–∑–≤–µ—Å—Ç–Ω–∞ –∏ –¥–æ–ø—É—Å—Ç–∏–º–∞.

---

## –ß–µ–∫-–ª–∏—Å—Ç –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á (–¥–µ–∫–∞–±—Ä—å 2024)

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

```
‚úÖ [DUP-3] –ò–∑–≤–ª–µ—á—å –æ–±—â—É—é —Ñ—É–Ω–∫—Ü–∏—é sampleColorFromSource –≤ lib/canvas-utils.ts
‚úÖ [DUP-4] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å sampleColorFromVideo –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ sampleContrastingColor
```

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

```
‚úÖ [ARCH-3] –°–æ–∑–¥–∞—Ç—å useAdjustmentMode —Ö—É–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–º —Ä—É—á–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏
‚úÖ [ARCH-4] –û–±—ä–µ–¥–∏–Ω–∏—Ç—å handleCaptureWithPosition –∏ handleCaptureFromFrozenFrame –≤ –µ–¥–∏–Ω—ã–π capture workflow
```

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ - –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```
‚è∏Ô∏è [ARCH-5] [–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø] –ò–∑–≤–ª–µ—á—å GalleryToolbar - –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑–∞–ª –Ω–µ—Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç—å
‚è∏Ô∏è [ARCH-6] [–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø] –ò–∑–≤–ª–µ—á—å GalleryContent - –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑–∞–ª –Ω–µ—Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç—å
‚è∏Ô∏è [DUP-5] [–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø] –°–æ–∑–¥–∞—Ç—å useSensorWithThreshold - —Ö—É–∫–∏ —Å–ª–∏—à–∫–æ–º —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è
‚è∏Ô∏è [DUP-6] [–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å use-orientation.ts - –¥–æ–±–∞–≤–∏—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å
‚úÖ [IMP-1] –°–æ–∑–¥–∞—Ç—å barrel export –¥–ª—è UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```

### Clean Code (–¥–µ–∫–∞–±—Ä—å 2025)

```
‚úÖ [CLEAN-1] –ó–∞–º–µ–Ω–∏—Ç—å console.log –Ω–∞ logger.debug –≤ CameraViewfinder.tsx:176
‚úÖ [CLEAN-2] –ó–∞–º–µ–Ω–∏—Ç—å console.log –Ω–∞ logger.debug –≤ CameraViewfinder.tsx:179
‚úÖ [CLEAN-3] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å _ ‚Üí _imageData, __ ‚Üí _thumbnailData –≤ photo-service.ts:150
‚úÖ [CLEAN-4] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å _ ‚Üí _imageData –≤ photo-service.ts:177
‚úÖ [CLEAN-5] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å _ ‚Üí _imageData –≤ photo-service.ts:243
```

---

## 11. –ê—É–¥–∏—Ç –¥–µ–∫–∞–±—Ä—å 2025 (08.12)

### 11.1 –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ triggerHapticFeedback
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**
- `client/src/pages/settings/components/QuickSettings.tsx` (—Å—Ç—Ä–æ–∫–∏ 7-10)
- `client/src/pages/settings/components/SettingsChips.tsx` (—Å—Ç—Ä–æ–∫–∏ 6-9)

**–ü—Ä–æ–±–ª–µ–º–∞:** –û–¥–∏–Ω–∞–∫–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∏–±—Ä–∞—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö.

**–†–µ—à–µ–Ω–∏–µ:** –í—ã–Ω–µ—Å—Ç–∏ –≤ `client/src/lib/haptic-utils.ts`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

```
‚úÖ [DUP-7] –°–æ–∑–¥–∞—Ç—å client/src/lib/haptic-utils.ts —Å —Ñ—É–Ω–∫—Ü–∏–µ–π triggerHapticFeedback
‚úÖ [DUP-8] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å QuickSettings –∏ SettingsChips –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—â–µ–π —Ñ—É–Ω–∫—Ü–∏–∏
```

### 11.2 –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ parseColor –∏ getOutlineColorForReticle
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**
- `client/src/components/reticles.tsx` (—Å—Ç—Ä–æ–∫–∏ 88-116)
- `client/src/lib/watermark-renderer.ts` (—Å—Ç—Ä–æ–∫–∏ 62-99)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Ü–≤–µ—Ç–∞ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ–≥–æ outline-—Ü–≤–µ—Ç–∞ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è –≤ –¥–≤—É—Ö —Ñ–∞–π–ª–∞—Ö.

**–†–µ—à–µ–Ω–∏–µ:** –í—ã–Ω–µ—Å—Ç–∏ –≤ –æ–±—â–∏–π –º–æ–¥—É–ª—å `client/src/lib/color-utils.ts`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

```
‚úÖ [DUP-9] –°–æ–∑–¥–∞—Ç—å client/src/lib/color-utils.ts —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ parseColor, getOutlineColorForReticle, colorToRgba
‚úÖ [DUP-10] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å reticles.tsx –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
‚úÖ [DUP-11] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å watermark-renderer.ts –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
```

### 11.3 –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π SettingsPage (645 —Å—Ç—Ä–æ–∫)
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/pages/settings/index.tsx`

**–ü—Ä–æ–±–ª–µ–º–∞:** –§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π, —Å–æ–¥–µ—Ä–∂–∏—Ç –º–Ω–æ–≥–æ –ª–æ–≥–∏–∫–∏: –≤–∞–ª–∏–¥–∞—Ü–∏—è API, –ø–∞—Ç—Ç–µ—Ä–Ω-–ª–æ–∫, –¥–∏–∞–ª–æ–≥–∏, –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–µ–∫—Ü–∏–π.

**–ê–Ω–∞–ª–∏–∑:**
- `categorySections` (—Å—Ç—Ä–æ–∫–∏ 204-315) –∏ `searchableSections` (—Å—Ç—Ä–æ–∫–∏ 319-441) —Å–æ–¥–µ—Ä–∂–∞—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –ø—Ä–æ–ø—Å–∞–º–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—ã–π –º–∞—Å—Å–∏–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ–∫—Ü–∏–π
2. –í—ã–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É –ø–∞—Ç—Ç–µ—Ä–Ω-–ª–æ–∫–∞ –≤ —Ö—É–∫
3. –í—ã–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏–∫—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏ API –≤ —Ö—É–∫

**–°—Ç–∞—Ç—É—Å:** üìã –ù–û–í–ê–Ø –ó–ê–î–ê–ß–ê

```
[ ] [ARCH-7] –°–æ–∑–¥–∞—Ç—å hooks/usePatternSetup.ts –¥–ª—è –ª–æ–≥–∏–∫–∏ –ø–∞—Ç—Ç–µ—Ä–Ω-–ª–æ–∫–∞
[ ] [ARCH-8] –°–æ–∑–¥–∞—Ç—å hooks/useApiKeyValidation.ts –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ ImgBB API
[ ] [ARCH-9] –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ–∫—Ü–∏–π settings –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
```

### 11.4 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ lazy loading –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/App.tsx`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å lazy loading –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (—Å–º. —Ä–∞–∑–¥–µ–ª 7.1)

### 11.5 –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ barrel exports –¥–ª—è hooks
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/hooks/`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∂–¥—ã–π —Ö—É–∫ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ, –Ω–µ—Ç –µ–¥–∏–Ω–æ–≥–æ `index.ts`.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

```
‚úÖ [IMP-2] –°–æ–∑–¥–∞—Ç—å client/src/hooks/index.ts —Å —Ä–µ—ç–∫—Å–ø–æ—Ä—Ç–æ–º –≤—Å–µ—Ö —Ö—É–∫–æ–≤
```

### 11.6 –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ canvas –¥–ª—è thumbnail
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/hooks/use-camera.ts` (—Å—Ç—Ä–æ–∫–∏ 266-284)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∫–∞–∂–¥–æ–º —Å–Ω–∏–º–∫–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π canvas —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è thumbnail (`document.createElement("canvas")`).

**–†–µ—à–µ–Ω–∏–µ:** –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å/–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å canvas —á–µ—Ä–µ–∑ ref.

**–°—Ç–∞—Ç—É—Å:** üìã –ù–ò–ó–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢

```
[ ] [PERF-4] [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å canvas –¥–ª—è thumbnail –≤ use-camera.ts
```

### 11.7 localStorage –≤ handleMove –∏–≥—Ä—ã 2048
**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `client/src/hooks/use-game-2048.ts` (—Å—Ç—Ä–æ–∫–∞ 174)

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ localStorage –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–≤–∏–∂–µ–Ω–∏–∏ –∏–≥—Ä—ã –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –º–∏–∫—Ä–æ-–ª–∞–≥–∏.

**–†–µ—à–µ–Ω–∏–µ:** Debounce —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ bestScore –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏/–ø–∞—É–∑–µ –∏–≥—Ä—ã.

**–°—Ç–∞—Ç—É—Å:** üìã –ù–ò–ó–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢

```
[ ] [PERF-5] [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] Debounce —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ bestScore –≤ use-game-2048.ts
```

---

## –ß–µ–∫-–ª–∏—Å—Ç –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á (–¥–µ–∫–∞–±—Ä—å 2025 - 08.12)

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)

```
‚úÖ [DUP-7] –°–æ–∑–¥–∞—Ç—å client/src/lib/haptic-utils.ts
‚úÖ [DUP-8] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å QuickSettings –∏ SettingsChips
‚úÖ [DUP-9] –°–æ–∑–¥–∞—Ç—å client/src/lib/color-utils.ts
‚úÖ [DUP-10] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å reticles.tsx
‚úÖ [DUP-11] –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å watermark-renderer.ts
```

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

```
[ ] [ARCH-7] –°–æ–∑–¥–∞—Ç—å hooks/usePatternSetup.ts
[ ] [ARCH-8] –°–æ–∑–¥–∞—Ç—å hooks/useApiKeyValidation.ts
[ ] [ARCH-9] –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–µ–∫—Ü–∏–π settings
‚úÖ [IMP-2] –°–æ–∑–¥–∞—Ç—å client/src/hooks/index.ts
```

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)

```
[ ] [PERF-4] [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å canvas –¥–ª—è thumbnail
[ ] [PERF-5] [–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û] Debounce —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ bestScore
```

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 08.12.2025)

| –§–∞–π–ª | –°—Ç—Ä–æ–∫–∏ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------|--------|-------------|
| client/src/components/ui/sidebar.tsx | 727 | shadcn/ui - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ |
| client/src/pages/settings/index.tsx | 645 | –¢—Ä–µ–±—É–µ—Ç –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ (—Å–º. 11.3) |
| client/src/pages/gallery/index.tsx | 642 | –õ–æ–≥–∏–∫–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ —Ö—É–∫–∏, –æ—Å—Ç–∞—ë—Ç—Å—è JSX |
| client/src/pages/camera/components/CameraViewfinder.tsx | 499 | –ü—Ä–∏–µ–º–ª–µ–º–æ |
| client/src/pages/camera/index.tsx | 489 | –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ (useAdjustmentMode) |
| client/src/lib/db/photo-service.ts | 459 | –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π |
| client/src/lib/i18n/ru.ts | 457 | –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è |
| client/src/lib/i18n/en.ts | 457 | –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è |
| client/src/lib/canvas-utils.ts | 377 | –£—Ç–∏–ª–∏—Ç—ã canvas |
| client/src/hooks/use-camera.ts | 370 | –•—É–∫ –∫–∞–º–µ—Ä—ã |

---

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –∫–æ–Ω–≤–µ–Ω—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ `client/src/docs/ARCHITECTURE.md`:
- UI Component Patterns (Radix/shadcn, overlayStyles, SettingRow/SettingSlider)
- Custom Hooks Architecture (useTouchTracking, useColorSampling, Gallery hooks)
- Database Layer (Service architecture, cache invalidation)
- Constants (LONG_PRESS, CAMERA, GESTURE, TIMING)
- Performance Patterns (Memoization, Parallel operations, Virtualization)
- State Management (Settings Context, captureConfig memoization)
- Code Organization (File size guidelines, Component structure)
